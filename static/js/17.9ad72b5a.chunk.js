(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1213:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(48),l=t(27),i=t(55),o=t(330),c=t(15),m=t(153),p=t(7),d=t(228),b=t(24),h=t(92),u=t(131),g=t(13),_=t(329),S=t(30),v=t(133),y=t(61),E=t.n(y);class k extends n.Component{constructor(e){super(e),this.state={isLoading:!1,isLoadingBatal:!1,FormModal:""},this.setStartDate=this.setStartDate.bind(this),this.setLastDate=this.setLastDate.bind(this)}componentDidMount(){}setStartDate(e){this.setState({tgl_awal:new Date(e)})}setLastDate(e){this.setState({tgl_akhir:new Date(e)})}render(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-4"},r.a.createElement(_.a,{name:"tgl_awal",component:S.c,label:"Tanggal Dari",type:"text",selected:this.state.tgl_awal,onChange:e=>this.setStartDate(e),placeholder:"Masukan Tanggal Dari"})),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement(_.a,{name:"tgl_akhir",component:S.c,type:"text",selected:this.state.tgl_akhir,onChange:e=>this.setLastDate(e),label:"Tanggal Akhir",placeholder:"Masukan Tanggal Akhir"})),r.a.createElement("div",{className:"col-4"},r.a.createElement("label",null," \xa0"),r.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoading,type:"submit"},this.props.isLoading?r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Mencari"):"Cari Services"))),this.props.isLoading?r.a.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}k=Object(o.a)({form:"HeadLihatServices",enableReinitialize:!0,validate:v.a})(k);var f=Object(s.b)(e=>({setTransaksiServices:e.services.setTransaksiServices,DataSales:e.datamaster.getDataSales,hideModal:e.datamaster.modalDialog,initialValues:{tgl_awal:Object(p.h)(),tgl_akhir:Object(p.h)()}}))(k),O=t(3),j=t(724);const N=Object(O.w)({prefix:"Rp. ",locale:"kr-KO"}),x=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}];class I extends O.b{constructor(e){super(e),this.state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]}}componentDidMount(){setTimeout(()=>{let e=Object(O.j)(document.getElementById("grand_total_pembayaran").value),a=Object(O.j)(document.getElementById("total_dp").value);this.props.change("harus_bayar_rp",parseInt(e)-parseInt(a))},100),this.props.dispatch(Object(c.sb)());let e=JSON.parse(localStorage.getItem("data_service_barang"));this.props.change("total_dp",e.dp_rp),this.props.change("grand_total_pembayaran",e.total),this.props.change("harus_bayar_rp",e.total),this.props.change("jenis","CASH")}hitungTotal(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}pilihPembyaran(e){"CASH"===e?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===e?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===e?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}copyValue(e){this.props.change("cash",parseInt(Object(O.j)(e)))}render(){return O.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},O.n.createElement("div",{className:"row"},O.n.createElement("div",{className:"col-4"},O.n.createElement(O.c,Object.assign({id:"grand_total_pembayaran",name:"grand_total_pembayaran",component:O.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},N,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),O.n.createElement("div",{className:"col-4"},O.n.createElement(O.c,Object.assign({id:"total_dp",name:"total_dp",component:O.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},N,{label:"Total Dp",placeholder:"Total Dp"}))),O.n.createElement("div",{className:"col-4"},O.n.createElement(O.c,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:O.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},N,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),O.n.createElement("div",{className:"col-6"},O.n.createElement(O.c,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:x,onChange:e=>this.pilihPembyaran(e),component:O.q})),O.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},O.n.createElement(O.c,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:O.p,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),O.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},O.n.createElement(O.c,{tabIndex:"1",name:"no_card",id:"no_card",component:O.p,type:"text",normalize:O.j,label:"TRANSFER"===this.state.type_pembayaran?"No Rek":"Card No",placeholder:"TRANSFER"===this.state.type_pembayaran?"Masukan No Rek":"Masukan Card No"})),O.n.createElement("div",{className:"col-6"},O.n.createElement(O.c,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:O.p,type:"text",label:"Nominal",onChange:this.hitungTotal()},N,{normalize:O.j,placeholder:"Masukan Nominal"}))),O.n.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},O.n.createElement(O.c,{tabIndex:"1",name:"fee",id:"fee",component:O.p,type:"text",label:"Fee (%)",normalize:O.j,placeholder:"5"})),O.n.createElement("div",{className:"col-6 d-none"},O.n.createElement(O.c,{tabIndex:"1",id:"nominal_kembali",name:"nominal_kembali",component:O.p,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),O.n.createElement("div",{className:"col-6"},O.n.createElement(O.c,{name:"kembali",id:"sisa_bayar",component:O.p,type:"text",readOnly:!0,label:"Sisa",onFocus:e=>this.copyValue(e.target.value),placeholder:"Sisa Pembayaran"})),O.n.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},O.n.createElement("br",null),O.n.createElement("label",null,"\xa0"),O.n.createElement("button",{tabIndex:"2",className:"btn btn-primary"}," ",O.n.createElement("i",{className:"fa fa-plus"})))))}}I=Object(O.O)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:j.a})(I);const A=Object(O.x)("HeadInputPembayaran");var C=Object(O.u)(e=>{const a=A(e,"grand_total_pembayaran","harus_bayar_rp","cash"),t=a.harus_bayar_rp,n=a.cash;let r=JSON.parse(localStorage.getItem("trx_pemabayran_service"))||[],s=0;r.forEach(e=>{s=e.nominal+s});let l=parseFloat(s||0)-parseFloat(t||0);return{kembali:l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_cash:n,nominal_kembali:l+parseInt(n)}})(I);class F extends O.b{constructor(e){super(e),this.state={isLoading:!1,type_pembayaran:"CASH",kembalian:"",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:e=>O.n.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(e,a,t)=>O.n.createElement("div",{className:"row text-center"},O.n.createElement("div",{className:"col-12"},O.n.createElement("button",{type:"button",disabled:"DP-SERVICE"===a.keterangan,onClick:()=>this.hapusdata(t),className:"btn btn-danger mr-3"},O.n.createElement("i",{className:"fa fa-trash"})))),footer:""}]}}hapusdata(e){O.r.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(a=>{if(a.isConfirmed){let a=Object(O.D)("trx_pemabayran_service");a.splice(e,1),Object(O.Q)("trx_pemabayran_service",a),this.setState({status:"berhasil"})}})}simpanPembayaran(e){if(void 0===e.no_card&&"CASH"!==e.jenis&&"DEBET"!==e.jenis)return Object(O.t)("info","Nomor kartu tidak boleh kosong"),!1;if(void 0===e.nama_bank&&"CASH"!==e.jenis)return Object(O.t)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===e.cash||"0"===e.cash)return Object(O.t)("info","Nominal tidak boleh kosong"),!1;let a={total_transaksi:e.harus_bayar_rp,sisa_bayar:e.nominal_kembali};Object(O.Q)("sisa_bayar_service",a);let t=JSON.parse(localStorage.getItem("trx_pemabayran_service"))||[];if("CASH"===e.jenis||t.length){if("CASH"!==e.jenis){if(e.kembali.replace(/[^0-9]/g,"")-e.cash<0&&0!==parseInt(e.kembali))return Object(O.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.reduce((e,a)=>e+a.nominal,0)>=e.harus_bayar_rp)return Object(O.t)("info","Pembayaran Sudah Cukup"),!1}}else if(e.kembali.replace(/[^0-9]/g,"")-e.cash<0)return Object(O.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.findIndex(e=>"CASH"===e.jenis)>=0){if(e.kembali.replace(/[^0-9]/g,"")-e.cash<0&&t.reduce((e,a)=>e+a.nominal,0)>e.harus_bayar_rp)return Object(O.t)("info","Pembayaran Sudah Cukup"),!1;if(t.reduce((e,a)=>e+a.nominal,0)>=e.harus_bayar_rp)return Object(O.t)("info","Pembayaran Sudah Cukup"),!1}if(-1===t.findIndex(a=>a.jenis===e.jenis)){let a="";a="CASH"===e.jenis?"CASH":"TRANSFER"===e.jenis?e.no_card+" - "+e.nama_bank:e.nama_bank;let n={jenis:e.jenis,nominal:parseInt(e.cash),nama_bank:void 0!==e.nama_bank?e.nama_bank.toUpperCase():"-",no_card:e.no_card,fee:"CREDIT"===e.jenis&&e.fee||0,keterangan:a,kembali:e.nominal_kembali};t.push(n),this.setState({masuk:!0,kembalian:e.kembali}),Object(O.Q)("trx_pemabayran_service",t)}else{let a=Object(O.D)("trx_pemabayran_service");a=a.map(a=>(a.jenis===e.jenis&&(a.nominal+=parseInt(e.cash)),a)),Object(O.Q)("trx_pemabayran_service",a),this.setState({status:!0,kembalian:e.kembalian})}}render(){return O.n.createElement(O.n.Fragment,null,O.n.createElement(C,{onSubmit:e=>this.simpanPembayaran(e)}),O.n.createElement("hr",null),O.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},O.n.createElement(O.s,{keyField:"jenis",exportCsv:!1,data:Object(O.D)("trx_pemabayran_service")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),O.n.createElement("div",{className:"row"},O.n.createElement("div",{className:"col-12 text-right"},O.n.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoadingPembayran,type:"submit"},this.props.isLoadingPembayran?O.n.createElement(O.n.Fragment,null,O.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang"))),this.props.isLoading?O.n.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}F=Object(O.O)({form:"ModalPembayaran",enableReinitialize:!0,validate:j.a})(F);var L=Object(O.u)(e=>{let a=Object(O.D)("data_barang_penjualan_tmp")||[],t="PENJUALAN";return a.forEach(e=>{t="-"===e.no_titip_group?"PENJUALAN":"TITIPAN"}),{status:t}})(F),M=t(134),T=t(740);const w=Object(M.createNumberMask)({prefix:"Rp. ",locale:"kr-KO"});class D extends n.Component{constructor(e){super(e),this.state={date:new Date("Y-m-d"),columns:[{dataField:"nama_barang",text:"Nama Barang",footer:""},{dataField:"berat",text:"Berat",formatter:e=>r.a.createElement("span",null,parseFloat(e).toFixed(1)),footer:e=>parseFloat(e.reduce((e,a)=>e+a,0)).toFixed(1)},{dataField:"jumlah",text:"Jumlah",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"ongkos",text:"Ongkos",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"total",text:"Total Rp",formatter:(e,a,t)=>this.getTotal(t),footer:(e,a,t)=>this.getTotalAll()}]}}getTotalAll(){let e=JSON.parse(localStorage.getItem("total_rp_service_ambil"))||[],a=0;return e.forEach((e,t)=>{a+=e.jml}),parseInt(a).toLocaleString("kr-KO")}getTotal(e){let a=JSON.parse(localStorage.getItem("total_rp_service_ambil"))||[],t={jml:parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah)};return a.push(t),localStorage.setItem("total_rp_service_ambil",JSON.stringify(a)),parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah).toLocaleString("kr-KO")}render(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{id:"no_faktur_services_ambil",name:"no_faktur_services",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,{name:"nama_customer",component:S.e,type:"text",readOnly:!0,label:"Nama Customer",placeholder:"Masukan Nama Customer"})),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{name:"alamat_customer",component:S.e,type:"text",readOnly:!0,label:"Alamat Customer",placeholder:"Masukan Alamat Customer"})),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{name:"no_hp",component:S.e,type:"text",readOnly:!0,label:"No Hp",placeholder:"Masukan No Hp"})),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{id:"total_bayar",name:"total_bayar",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,{id:"total_dp",name:"total_dp_pembayarn",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,Object.assign({id:"total_rp",name:"total_rp",component:S.e},w,{type:"text",label:"Total Rp",readOnly:!0}))),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,Object.assign({name:"total_dp",component:S.e,type:"telp"},w,{label:"Total DP",readOnly:!0}))),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,Object.assign({name:"sisa_rp",component:S.e,type:"telp"},w,{label:"Sisa Rp",readOnly:!0}))),r.a.createElement("div",{className:"col-3 d-none"},r.a.createElement(_.a,{defaultValue:this.state.date,id:"tgl_ambil",name:"tgl_ambil",component:S.e,type:"date",label:"Tanggal Ambil"})),r.a.createElement("div",{className:"col-12"},r.a.createElement(h.a,{keyField:"nama_barang",exportCsv:!1,data:this.props.detail_barang,columns:this.state.columns,pagination:"off",empty:!0,textEmpty:"Data Barang Kosong"})),r.a.createElement("div",{className:"col-3"},r.a.createElement("button",{type:"button",onClick:this.props.back,className:"btn btn-primary btn-block"},r.a.createElement("i",{className:"fa fa-arrow-left"})," Kembali")),r.a.createElement("div",{className:"col-9"},0===JSON.parse(localStorage.getItem("sisa_bayar_service_ambil"))?r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Service Ambil"):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",onClick:()=>this.props.showModalPembayaran(),className:"btn btn-success btn-block"},"Service Ambil")))),r.a.createElement("br",null),this.props.isLoading?r.a.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}D=Object(o.a)({form:"ModalServicesAmbil",enableReinitialize:!0,validate:T.a})(D);var B=Object(s.b)(e=>(localStorage.setItem("sisa_bayar_service_ambil",parseFloat(e.services.showModalServiceAmbil.total||0)-parseFloat(e.services.showModalServiceAmbil.dp_rp||0)||0),{detail_barang:e.services.showModalServiceAmbil.detail_barang,initialValues:{sisa_rp:parseFloat(e.services.showModalServiceAmbil.total||0)-parseFloat(e.services.showModalServiceAmbil.dp_rp||0)||0,no_faktur_services:e.services.showModalServiceAmbil.no_faktur_service,nama_customer:e.services.showModalServiceAmbil.nama_customer,alamat_customer:e.services.showModalServiceAmbil.alamat_customer,no_hp:e.services.showModalServiceAmbil.no_hp,total_dp_pembayarn:e.services.showModalServiceAmbil.dp_rp,total_dp:e.services.showModalServiceAmbil.dp_rp,total_rp:e.services.showModalServiceAmbil.total,total_bayar:e.services.showModalServiceAmbil.total,tgl_ambil:Object(p.i)()}}))(D);const R=Object(M.createNumberMask)({prefix:"Rp. ",locale:"kr-KO"});class K extends n.Component{constructor(e){super(e),this.state={date:new Date("Y-m-d"),columns:[{dataField:"nama_barang",text:"Nama Barang",footer:""},{dataField:"berat",text:"Berat",formatter:e=>r.a.createElement("span",null,parseFloat(e).toFixed(1)),footer:e=>parseFloat(e.reduce((e,a)=>e+a,0)).toFixed(1)},{dataField:"jumlah",text:"Jumlah",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"ongkos",text:"Ongkos",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"total",text:"Total Rp",formatter:(e,a,t)=>this.getTotal(t),footer:(e,a,t)=>this.getTotalAll()}]}}getTotalAll(){let e=JSON.parse(localStorage.getItem("total_rp_service_ambil"))||[],a=0;return e.forEach((e,t)=>{a+=e.jml}),parseInt(a).toLocaleString("kr-KO")}getTotal(e){let a=JSON.parse(localStorage.getItem("total_rp_service_ambil"))||[],t={jml:parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah)};return a.push(t),localStorage.setItem("total_rp_service_ambil",JSON.stringify(a)),parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah).toLocaleString("kr-KO")}render(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{id:"no_faktur_services_ambil",name:"no_faktur_services",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,{name:"nama_customer",component:S.e,type:"text",readOnly:!0,label:"Nama Customer",placeholder:"Masukan Nama Customer"})),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{name:"alamat_customer",component:S.e,type:"text",readOnly:!0,label:"Alamat Customer",placeholder:"Masukan Alamat Customer"})),r.a.createElement("div",{className:"col-4"},r.a.createElement(_.a,{name:"no_hp",component:S.e,type:"text",readOnly:!0,label:"No Hp",placeholder:"Masukan No Hp"})),r.a.createElement("div",{className:"col-3"},r.a.createElement(_.a,{id:"total_bayar",name:"total_bayar",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,Object.assign({id:"total_rp",name:"total_rp",component:S.e},R,{type:"text",label:"Total Rp",readOnly:!0}))),r.a.createElement("div",{className:"col-3"},r.a.createElement(_.a,Object.assign({name:"total_dp",component:S.e,type:"telp"},R,{label:"Total DP",readOnly:!0}))),r.a.createElement("div",{className:"col-3"},r.a.createElement(_.a,Object.assign({name:"sisa_rp",component:S.e,type:"telp"},R,{label:"Sisa Rp",readOnly:!0}))),r.a.createElement("div",{className:"col-3"},r.a.createElement(_.a,{defaultValue:this.state.date,id:"tgl_ambil",name:"tgl_ambil",component:S.e,type:"date",label:"Tanggal Ambil"})),r.a.createElement("div",{className:"col-12"},r.a.createElement(h.a,{keyField:"nama_barang",exportCsv:!1,data:this.props.detail_barang,columns:this.state.columns,pagination:"off",empty:!0,textEmpty:"Data Barang Kosong"})),r.a.createElement("div",{className:"col-3"},r.a.createElement("button",{type:"button",onClick:this.props.back,className:"btn btn-primary btn-block"},r.a.createElement("i",{className:"fa fa-arrow-left"})," Kembali")),r.a.createElement("div",{className:"col-9"},0===JSON.parse(localStorage.getItem("sisa_bayar_service_ambil"))?r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Batal Service"):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},"Batal Service")))),r.a.createElement("br",null))}}K=Object(o.a)({form:"ModalServicesBatal",enableReinitialize:!0,validate:T.a})(K);var P=Object(s.b)(e=>(localStorage.setItem("sisa_bayar_service_ambil",parseFloat(e.services.showModalServiceAmbil.total||0)-parseFloat(e.services.showModalServiceAmbil.dp_rp||0)||0),{detail_barang:e.services.showModalServiceAmbil.detail_barang,initialValues:{sisa_rp:parseFloat(e.services.showModalServiceAmbil.total||0)-parseFloat(e.services.showModalServiceAmbil.dp_rp||0)||0,no_faktur_services:e.services.showModalServiceAmbil.no_faktur_service,nama_customer:e.services.showModalServiceAmbil.nama_customer,alamat_customer:e.services.showModalServiceAmbil.alamat_customer,no_hp:e.services.showModalServiceAmbil.no_hp,total_dp:e.services.showModalServiceAmbil.dp_rp,total_rp:e.services.showModalServiceAmbil.total,total_bayar:e.services.showModalServiceAmbil.total,tgl_ambil:Object(p.i)()}}))(K);class H extends n.Component{constructor(e){super(e),this.state={columns:[{dataField:"nama_barang",text:"Nama Barang",footer:""},{dataField:"berat",text:"Berat",formatter:e=>r.a.createElement("span",null,parseFloat(e).toFixed(1)),footer:e=>parseFloat(e.reduce((e,a)=>e+a,0)).toFixed(1)},{dataField:"jumlah",text:"Jumlah",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"ongkos",text:"Ongkos",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"total",text:"Total Rp",formatter:(e,a,t)=>this.getTotal(t),footer:(e,a,t)=>this.getTotalAll()}]}}getTotalAll(){let e=JSON.parse(localStorage.getItem("total_rp_services"))||[],a=0;return e.forEach((e,t)=>{a+=e.jml}),parseInt(a).toLocaleString("kr-KO")}getTotal(e){let a=JSON.parse(localStorage.getItem("total_rp_services"))||[],t={jml:parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah)};return a.push(t),localStorage.setItem("total_rp_services",JSON.stringify(a)),parseInt(this.props.detail_barang[e].ongkos*this.props.detail_barang[e].jumlah).toLocaleString("kr-KO")}render(){return r.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement(_.a,{name:"no_faktur_services",component:S.b,type:"hidden",readOnly:!0}),r.a.createElement(_.a,{name:"nama_customer",component:S.e,type:"text",readOnly:!0,label:"Nama Customer",placeholder:"Masukan Nama Cistomer"})),r.a.createElement("div",{className:"col-6"},r.a.createElement(_.a,{name:"alamat_customer",component:S.e,type:"text",readOnly:!0,label:"Nama Customer",placeholder:"Masukan Alamat Cistomer"})),r.a.createElement("div",{className:"col-6"},r.a.createElement(_.a,{name:"no_hp",component:S.e,type:"number",label:"No Hp",readOnly:!0,placeholder:"Masukan No Hp"})),r.a.createElement("div",{className:"col-12"},r.a.createElement(h.a,{keyField:"nama_barang",exportCsv:!1,data:this.props.detail_barang,columns:this.state.columns,pagination:"off",empty:!0,textEmpty:"Data Barang Kosong"})),r.a.createElement("div",{className:"col-12"},r.a.createElement("button",{type:"submit",disabled:this.props.isLoadingServicesSelesai,className:"btn btn-primary btn-block"},this.props.isLoadingServicesSelesai?r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan Data"):"Service Selesai"))),this.props.isLoadingServicesSelesai?r.a.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}H=Object(o.a)({form:"ModalServicesSelesai",enableReinitialize:!0,validate:T.a})(H);var J=Object(s.b)(e=>({detail_barang:e.services.showModalServiceSelesai.detail_barang,initialValues:{no_faktur_services:e.services.showModalServiceSelesai.no_faktur_service,nama_customer:e.services.showModalServiceSelesai.nama_customer,alamat_customer:e.services.showModalServiceSelesai.alamat_customer,no_hp:e.services.showModalServiceSelesai.no_hp,tgl_selesai:Object(p.i)()}}))(H),V=t(108);class z extends r.a.Component{constructor(e){super(e),this.state={isLoadingServicesSelesai:!1,isLoading:!1,dataservices:[],FormModal:"",pembayaran:!1,columns:[{dataField:"no_faktur_service",text:"No Faktur",footerAttrs:{colSpan:"4"},footer:"Total"},{dataField:"nama_customer",text:"Nama Customer"},{dataField:"alamat_customer",text:"Alamat Customer"},{dataField:"no_hp",text:"No Hp"},{dataField:"dp_rp",text:"Dp Rp",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"total",text:"Total Rp",formatter:e=>r.a.createElement("span",null,parseInt(e).toLocaleString("kr-KO")),footer:e=>parseInt(e.reduce((e,a)=>e+a,0)).toLocaleString("kr-KO")},{dataField:"selesai",text:"Selesai",csvExport:!1,headerClasses:"text-center",formatter:(e,a,t)=>r.a.createElement("div",{className:"row text-center"},r.a.createElement("div",{className:"col-12"},"OPEN"===a.status_proses?r.a.createElement("button",{type:"button","data-tooltip":"Service Selesai",onClick:()=>this.showModalServiceSelesai(a),className:"btn btn-success "},r.a.createElement("i",{className:"fas fa-check"})):null,"DONE"===a.status_proses?r.a.createElement("button",{type:"button","data-tooltip":"Service Ambil",onClick:()=>this.showModalServiceAmbil(a),className:"btn btn-warning"},r.a.createElement("i",{className:"fa fa-file-export"})):null,"OPEN"===a.status_proses||"DONE"===a.status_proses?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement("br",null)," "):r.a.createElement(r.a.Fragment,null),r.a.createElement("button",{type:"button","data-tooltip":"Service Batal",onClick:()=>this.showBatalServices(a),className:"btn btn-danger"},r.a.createElement("i",{className:"fa fa-window-close"})),"\xa0",r.a.createElement("button",{type:"button","data-tooltip":"Reprint Service",onClick:()=>this.Reprint(a),className:"btn btn-secondary"},r.a.createElement("i",{className:"fa fa-print"})))),footer:""}]},this.handleSubmit=this.handleSubmit.bind(this)}componentDidMount(){localStorage.setItem("total_rp_services",JSON.stringify([])),!1===this.state.pembayaran&&(Object(p.p)("sisa_bayar_service",[]),Object(p.p)("trx_pemabayran_service",[]))}showBatalServices(e){localStorage.setItem("total_rp_service_ambil",JSON.stringify([])),this.setState({FormModal:"SERVICE_BATAL",pembayaran:!0}),this.props.dispatch(Object(m.e)(e))}Reprint(e){let a={no_faktur_service:e.no_faktur_service};Object(g.j)("service/get/bynota",a).then(e=>{let a=[];for(let t=0;t<2;t++){let t="";e.data.notaservice.forEach((e,a)=>{let n=e.n_alamat_customer.length;t+="========================================\n",t+="             NOTA SERVICE               \n",t+="========================================\nTanggal          : ".concat(e.tgl_system,"\nKode Sales       : ").concat(e.kode_sales,"\nNama Customer    : ").concat(e.nama_customer,"\nNo Hp            : ").concat(e.no_hp,"\nAlamat Customer  : ").concat(e.n_alamat_customer.slice(0,20),"\nTotal Service    : ").concat(e.total_service.toLocaleString("kr-KO"),"\n"),n>20&&(t+="      ".concat(e.n_alamat_customer.slice(20,40),"\n")),n>40&&(t+="      ".concat(e.n_alamat_customer.slice(40,60),"\n")),t+="========================================\n",t+="Keterangan\n",t+="========================================\n";let r=0,s=0;e.detail_barang.forEach((a,n)=>{r+=a.ongkos;let l=a.deskripsi.length;s+=a.harga_nota,t+="Nama Barang      : ".concat(a.nama_barang,"\n"),t+="Berat            : ".concat(a.berat.toFixed(3),"\n"),t+="Jumlah           : ".concat(a.jumlah.toLocaleString("kr-KO"),"\n"),t+="Ongkos           : ".concat(a.ongkos.toLocaleString("kr-KO"),"\n"),t+="deskripsi        : ".concat(a.deskripsi.slice(0,20),"\n"),l>20&&(t+="                   ".concat(e.deskripsi.slice(20,40))),l>40&&(t+="                   ".concat(e.deskripsi.slice(40,60))),t+="========================================\n"}),t+="Total Ongkos     : ".concat(r.toLocaleString("kr-KO"),"\n"),t+="========================================\n",t+="                               TTD      \n",t+="                                        \n",t+="                                        \n",t+="                                        \n",t+="                         (             )\n",t+="                                        \n",t+="                                        \n",t+="                                        \n"}),a.push(t)}document.getElementById("myInput").value=a.join("")}).then(()=>{console.log("masuk");const e=document.createElement("a"),a=new Blob([document.getElementById("myInput").value],{type:"text/plain;charset=utf-8"});e.href=URL.createObjectURL(a),e.download="autoprint_service.txt",document.body.appendChild(e),e.click()}).catch(e=>{})}handleSubmit(e){let a={tgl_awal:Object(p.e)(V(new Date(e.tgl_awal)).format("YYYY-MM-DD")),tgl_akhir:Object(p.e)(V(new Date(e.tgl_akhir)).format("YYYY-MM-DD"))};this.setState({isLoading:!0}),Object(g.j)("service/get/by-tanggal",a).then(e=>{Object(p.m)("tgl_laporan",JSON.stringify(a)),0===e.data.length?(Object(b.e)("info","Data Services Tidak Ada"),this.setState({isLoading:!1,dataservices:[]})):(Object(b.e)("success","Data Services Tersedia"),this.setState({isLoading:!1,dataservices:e.data}))}).catch(e=>this.errorhandling(e))}errorhandling(e){this.setState({isLoading:!1,dataservices:[]}),Object(b.e)("info",void 0===e.response?"Terjadi Kesalahan Saat Request Data":e.response.data)}showModalServiceSelesai(e){this.props.dispatch(Object(c.Bb)()),this.props.dispatch(Object(m.f)(e)),this.setState({pembayaran:!1})}showModalPembayaran(){if(""===document.getElementById("tgl_ambil").value)return Object(b.e)("info","Tanggal Ambil Harus Diisi"),!1;this.props.dispatch(Object(c.Bb)())}showModalServiceAmbil(e){Object(p.p)("data_service_barang",e),localStorage.setItem("total_rp_service_ambil",JSON.stringify([])),this.setState({FormModal:"SERVICE_AMBIL",pembayaran:!0}),this.props.dispatch(Object(m.e)(e))}simpanServicesSelesai(e){this.setState({isLoadingServicesSelesai:!0});let a={no_faktur_service:e.no_faktur_services,tgl_selesai:e.tgl_selesai};Object(g.j)("service/selesai",a).then(e=>{Object(b.d)(e.data),this.setState({isLoadingServicesSelesai:!1}),this.props.dispatch(Object(i.d)("ModalServicesSelesai"))}).then(()=>{this.getLaporan()}).then(()=>{this.props.dispatch(Object(c.Ab)()),localStorage.setItem("total_rp_services",JSON.stringify([]))}).catch(e=>{this.setState({isLoadingServicesSelesai:!1}),Object(b.e)("info","Data Services Gagal Disimpan")})}getLaporan(){let e=Object(p.g)("tgl_laporan"),a={tgl_awal:e.tgl_awal,tgl_akhir:e.tgl_akhir};Object(g.j)("service/get/by-tanggal",a).then(e=>{0===e.data.length?this.setState({isLoading:!1,dataservices:[]}):this.setState({isLoading:!1,dataservices:e.data})}).catch(e=>this.setState({isLoading:!1,dataservices:[]}))}simpanServicesAmbil(e){this.setState({isLoadingServicesSelesai:!0});let a=document.getElementById("no_faktur_services_ambil").value,t=parseInt(document.getElementById("total_bayar").value),n=parseInt(document.getElementById("total_dp").value),r=Object(p.g)("trx_pemabayran_service"),s=[],l="";r.forEach(e=>{let a={bank:"CASH"!==e.jenis?e.nama_bank:"CASH",jenis:e.jenis,keterangan:e.keterangan,fee:"CREDIT"===e.jenis&&parseInt(e.fee)||0,jumlah_rp:"CASH"===e.jenis?parseInt(e.nominal)-parseInt(Object(p.g)("sisa_bayar_service").sisa_bayar):parseInt(e.nominal)};l=e.nominal+l,s.push(a)});let o={no_faktur_service:a,tgl_ambil:"2021-01-01",total:t,pembayaran:s};if(parseInt(t)-n>parseInt(l)){let e=parseInt(t)-n-parseInt(l);return Object(b.e)("info","Pembayaran Masih Kurang "+parseInt(e).toLocaleString("kr-KO")),!1}Object(g.j)("service/ambil",o).then(e=>{this.setState({isLoadingServicesSelesai:!1}),Object(b.d)(e.data)}).then(()=>{this.setState({isLoadingServicesSelesai:!1}),this.props.dispatch(Object(i.d)("ModalPembayaran"))}).then(()=>{this.setState({isLoadingServicesSelesai:!1}),this.getLaporan()}).then(()=>{this.props.dispatch(Object(c.Ab)()),this.setState({FormModal:"",pembayaran:!1,dataservices:[],isLoadingServicesSelesai:!1}),Object(p.p)("sisa_bayar_service",[]),Object(p.p)("sisa_bayar_service_ambil",[]),Object(p.p)("trx_pemabayran_service",[]),Object(p.p)("total_rp_service_ambil",[]),Object(p.p)("data_service_barang",[])}).catch(e=>{this.setState({isLoadingServicesSelesai:!1}),Object(b.e)("info","Data Services Gagal Disimpan")})}simpanServicesBatal(e){let a={no_faktur_service:e.no_faktur_services};Object(g.j)("service/batal",a).then(e=>{Object(b.d)(e.data)}).then(()=>{this.props.dispatch(Object(i.d)("ModalPembayaran"))}).then(()=>{this.props.dispatch(Object(c.Ab)()),this.setState({FormModal:"",pembayaran:!1,dataservices:[]})}).then(()=>{this.getLaporan()}).catch(e=>{Object(b.e)("info","Data Services Gagal Disimpan")})}back(){localStorage.setItem("total_rp_service_ambil",JSON.stringify([])),this.setState({FormModal:""}),this.setState({pembayaran:!1}),Object(p.p)("sisa_bayar_service",[]),Object(p.p)("trx_pemabayran_service",[])}render(){return r.a.createElement("div",null,r.a.createElement("ol",{className:"breadcrumb float-xl-right"},r.a.createElement("li",{className:"breadcrumb-item"},r.a.createElement(l.b,{to:"#"},"Services")),r.a.createElement("li",{className:"breadcrumb-item active"},"Lihat Services")),r.a.createElement("h1",{className:"page-header"},"Lihat Services "),r.a.createElement(u.a,null,r.a.createElement("textarea",{style:{display:"none"},id:"myInput",rows:"100",cols:"100"}),r.a.createElement(u.c,null,"Lihat Services"),r.a.createElement("br",null),r.a.createElement("div",{className:"container"},"SERVICE_AMBIL"===this.state.FormModal?r.a.createElement(B,{showModalPembayaran:()=>this.showModalPembayaran(),back:()=>this.back(),onSubmit:e=>this.simpanServicesAmbil(e)}):"SERVICE_BATAL"===this.state.FormModal?r.a.createElement(P,{back:()=>this.back(),onSubmit:e=>this.simpanServicesBatal(e)}):r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{onSubmit:e=>this.handleSubmit(e),isLoading:this.state.isLoading}),r.a.createElement(h.a,{keyField:"no_faktur_group",exportCsv:!1,data:this.state.dataservices,columns:this.state.columns,empty:!0,textEmpty:"Data Barang Kosong"})))),r.a.createElement(d.a,{title:r.a.createElement(Y,{state:this.state.pembayaran}),size:this.state.pembayaran?"P":"xl",content:!0===this.state.pembayaran?r.a.createElement(L,{onSubmit:e=>this.simpanServicesAmbil(e)}):r.a.createElement(J,{isLoadingServicesSelesai:this.state.isLoadingServicesSelesai,onSubmit:e=>this.simpanServicesSelesai(e)})}),this.state.isLoadingServicesSelesai?r.a.createElement(E.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}function Y(e,a){return!0===e.state?"Form Pembayaran Service Ambil":"Form Services Selesai"}z=Object(o.a)({form:"LihatServices",enableReinitialize:!0})(z);a.default=Object(s.b)(e=>({hideModal:e.datamaster.modalDialog}),null)(z)},724:function(e,a,t){"use strict";a.a=(e=>{const a={};return e.jenis||(a.jenis="Jenis Tidak Boleh Kosong"),a})},740:function(e,a,t){"use strict";a.a=(e=>{const a={};return e.tgl_selesai||(a.tgl_selesai="Tanggal Selesai Tidak Boleh Kosong"),e.tgl_ambil||(a.tgl_ambil="Tanggal Tidak Boleh Kosong"),a})}}]);
//# sourceMappingURL=17.9ad72b5a.chunk.js.map