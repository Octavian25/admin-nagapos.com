(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{1215:function(e,a,t){"use strict";t.r(a);var n=t(0),o=t.n(n),l=t(48),r=t(27),s=t(55),i=t(330),m=t(15),c=t(228),d=t(24),b=t(131),p=t(13);class g extends n.Component{constructor(e){super(e),this.state={}}render(){return o.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.props.btnKosongkanDataOpname},"Kosongkan Data Opname")),o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{onClick:this.props.lanjutOpname,className:"btn btn-primary btn-block",type:"button"},"Lanjut Opname")),o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{className:"btn btn-primary btn-block",onClick:this.props.lihatstockopname,disabled:this.props.loadingLihatSTockOpname,type:"button"},this.props.loadingLihatSTockOpname?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Lihat Hasil Opname"):"Lihat Hasil Opname"))))}}g=Object(i.a)({form:"HeadStockOpname",enableReinitialize:!0})(g);var h=Object(l.b)()(g),k=t(329),u=t(30);var _=e=>{const a={};return e.baki_opname||(a.baki_opname="Kode Baki Tidak Boleh Kosong"),a};class O extends n.Component{constructor(e){super(e),this.state={batal:!1,isLoadingKosongkanBaki:!1}}batal(){this.props.dispatch(Object(m.Ab)())}componentDidMount(){this.props.dispatch(Object(m.kb)())}render(){return o.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:e=>{"Enter"===e.key&&e.preventDefault()},autoComplete:"off"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-12"},o.a.createElement("button",{className:"btn btn-primary btn-block",onClick:()=>this.props.kosongkanDataBaki(),disabled:this.state.isLoadingKosongkanBaki,type:"button"},this.state.isLoadingKosongkanBaki?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Kosongkan Data Opname"):"Kosongkan Data Opname"),o.a.createElement("br",null)),o.a.createElement("div",{className:"col-12"},o.a.createElement(k.a,{name:"baki_opname",label:"Baki Opname",placeholder:"Pilih Baki Opname",options:this.props.getDataBaki.filter(e=>void 0!==e.kode_baki).map(e=>{return{value:e.kode_baki,name:e.kode_baki+" - "+e.nama_baki}}),component:u.f})),o.a.createElement("div",{className:"col-12"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-6"},o.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoadingBakiOpname,type:"submit"},this.props.isLoadingBakiOpname?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Opname"):"Opname")),o.a.createElement("div",{className:"col-6"},o.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.state.batal,type:"button",onClick:()=>this.batal()},this.state.batal?o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Batal"):"Batal"))))))}}O=Object(i.a)({form:"KosongKanDataOpname",enableReinitialize:!0,validate:_})(O);var E=Object(l.b)(e=>({getDataBaki:e.datamaster.getDataBaki}))(O),S=t(3);class N extends n.Component{constructor(e){super(e),this.state={loadingData:!1}}componentDidMount(){setTimeout(()=>{document.getElementById("kode_barcode").focus()},100)}cekBarcode(e){clearTimeout(this.delayTimer),this.delayTimer=setTimeout(()=>{if(this.setState({loadingData:!0}),""===e)return this.setState({loadingData:!1,databarang:[]}),!1;let a={kode_barcode:e};Object(p.j)("opname/add",a).then(e=>{Object(d.e)("success","Data Berhasil Ditambahkan"),console.log(e.data),this.setState({loadingData:!1}),e.data.barang.forEach((e,a)=>{this.props.change("kode_toko",e.kode_toko),this.props.change("kode_dept",e.kode_dept),this.props.change("nama_barang",e.nama_barang),this.props.change("nama_atribut",e.nama_atribut),this.props.change("kode_intern",e.kode_intern),this.props.change("berat",e.berat)}),this.props.change("kode_barcode",""),document.getElementById("kode_barcode").focus()}).catch(e=>{this.setState({loadingData:!1}),this.props.change("kode_toko",""),this.props.change("kode_dept",""),this.props.change("nama_barang",""),this.props.change("nama_atribut",""),this.props.change("kode_intetn",""),this.props.change("berat",""),Object(d.e)("info",e.response.data),this.props.change("kode_barcode",""),document.getElementById("kode_barcode").focus()})},300)}batal(){this.props.dispatch(Object(m.Ab)())}render(){return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-12"},o.a.createElement(k.a,{id:"kode_barcode",name:"kode_barcode",onChange:e=>this.cekBarcode(e.target.value),label:"Kode Barcode",type:"text",normalize:e=>e.replace(/[^\d]/g,""),placeholder:"Silahkan Masukan Kode Barcode",component:u.e,maxLength:"8"})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{name:"kode_toko",label:"Kode Baki",type:"text",readOnly:!0,placeholder:"Silahkan Masukan Kode Baki",component:u.e})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{name:"kode_dept",type:"text",readOnly:!0,label:"Kode Jenis",placeholder:"Silahkan Masukan Kode Jenis",component:u.e})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{name:"kode_intern",type:"text",readOnly:!0,label:"Kode Intern",placeholder:"Silahkan Masukan Kode Intern",component:u.e})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{name:"berat",type:"text",readOnly:!0,label:"Berat",placeholder:"Silahkan Masukan Berat",component:u.e})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{name:"nama_barang",readOnly:!0,type:"text",label:"Nama Barang",placeholder:"Silahkan Masukan Nama Barang",component:u.e})),o.a.createElement("div",{className:"col-6"},o.a.createElement(k.a,{readOnly:!0,type:"text",name:"nama_atribut",label:"Nama Atribut",placeholder:"Silahkan Masukan Nama Atribut",component:u.e})),o.a.createElement("div",{className:"col-12"},o.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.state.batal,type:"button",onClick:()=>this.batal()},"Kembali")),this.state.loadingData?o.a.createElement(o.a.Fragment,null,o.a.createElement(S.h,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"})):null)}}N=Object(i.a)({form:"ProsesOpname",enableReinitialize:!0})(N);var y=Object(l.b)()(N),f=t(92);class B extends n.Component{constructor(e){super(e),this.state={}}render(){return o.a.createElement(f.a,{keyField:"kode_barcode",data:this.props.data,columns:this.props.tbl_barang_tidak_ketemu,empty:!0,textEmpty:"Data Barang Kosong"})}}B=Object(i.a)({form:"TabelLihatBarangTidakKetemu",enableReinitialize:!0})(B);var K=Object(l.b)()(B);class v extends n.Component{constructor(e){super(e),this.state={}}render(){return o.a.createElement(f.a,{keyField:"kode_barcode",data:this.props.data,columns:this.props.tbl_barang_ketemu,empty:!0,textEmpty:"Data Barang Kosong"})}}v=Object(i.a)({form:"TabelListBarangKetemu",enableReinitialize:!0})(v);var j=Object(l.b)()(v);class D extends o.a.Component{constructor(e){super(e),this.state={isLoading:!1,FormModal:"",barangHilang:[],barangKetemu:[],isLoadingBakiOpname:!1,loadingLihatSTockOpname:!1,tbl_barang_tidak_ketemu:[{dataField:"kode_toko",text:"Kode Baki ",footer:"",footerAttrs:{colSpan:"3"}},{dataField:"kode_barcode",text:"Kode Barcode"},{dataField:"kode_group",text:"Kategori"},{dataField:"kode_dept",text:"Kode Jenis",footer:"Total Qty"},{dataField:"nama_barang",text:"Nama Barang",footer:(e,a)=>null===localStorage.getItem("total_qty_brg_hilang")?0:parseInt(localStorage.getItem("total_qty_brg_hilang"))},{dataField:"nama_atribut",text:"Nama Atribut",footer:"Total Berat"},{dataField:"berat",text:"Berat",footer:(e,a)=>null===localStorage.getItem("total_berat_brg_hilang")?0:parseFloat(localStorage.getItem("total_berat_brg_hilang")).toFixed(3)}],tbl_barang_ketemu:[{dataField:"kode_toko",text:"Kode Baki ",footer:"",footerAttrs:{colSpan:"3"}},{dataField:"kode_barcode",text:"Kode Barcode"},{dataField:"kode_group",text:"Kategori"},{dataField:"kode_dept",text:"Kode Jenis",footer:"Total Qty"},{dataField:"nama_barang",text:"Nama Barang",footer:(e,a)=>null===localStorage.getItem("total_qty_brg_ketemu")?0:parseInt(localStorage.getItem("total_qty_brg_ketemu"))},{dataField:"nama_atribut",text:"Nama Atribut",footer:"Total Berat"},{dataField:"berat",text:"Berat",footer:(e,a)=>null===localStorage.getItem("total_berat_brg_ketemu")?0:parseFloat(localStorage.getItem("total_berat_brg_ketemu")).toFixed(3)}]},this.btnOpname=this.btnOpname.bind(this)}componentDidMount(){localStorage.setItem("total_berat_brg_ketemu",0),localStorage.setItem("total_berat_brg_hilang",0),localStorage.setItem("total_qty_brg_ketemu",0),localStorage.setItem("total_qty_brg_hilang",0)}componentWillUnmount(){localStorage.setItem("total_berat_brg_ketemu",0),localStorage.setItem("total_berat_brg_hilang",0),localStorage.setItem("total_qty_brg_ketemu",0),localStorage.setItem("total_qty_brg_hilang",0)}btnOpname(e){this.setState({isLoadingBakiOpname:!0});let a={kode_baki:e.baki_opname};Object(p.j)("opname/by-kode-baki/",a).then(e=>{Object(d.e)("success",e.data.message),this.props.dispatch(Object(s.d)("KosongKanDataOpname"))}).then(()=>{this.setState({isLoadingBakiOpname:!1}),this.props.dispatch(Object(m.Ab)()),this.lihatstockopname()}).catch(e=>{this.setState({isLoadingBakiOpname:!1}),Object(d.e)("info",void 0===e.response?"Terjadi Kesalahan Saat Request Data":e.response.data)})}btnKosongkanDataOpname(){this.props.dispatch(Object(m.Bb)()),this.setState({FormModal:"KOSONGKANOPNAME"})}lanjutOpname(){this.props.dispatch(Object(m.Bb)()),this.setState({FormModal:"LANJUTOPNAME"})}lihatstockopname(){this.setState({loadingLihatSTockOpname:!0}),Object(p.d)("opname/get/hasil").then(e=>{this.setState({loadingLihatSTockOpname:!1}),e.data.forEach(e=>{let a=e.barang_ketemu.map(e=>e.berat).reduce((e,a)=>e+a,0),t=e.barang_hilang.map(e=>e.berat).reduce((e,a)=>e+a,0);localStorage.setItem("total_berat_brg_ketemu",JSON.stringify(a)),localStorage.setItem("total_berat_brg_hilang",JSON.stringify(t)),localStorage.setItem("total_qty_brg_ketemu",JSON.stringify(e.barang_ketemu.length)),localStorage.setItem("total_qty_brg_hilang",JSON.stringify(e.barang_hilang.length)),this.setState({barangKetemu:e.barang_ketemu,barangHilang:e.barang_hilang})})}).catch(e=>{this.setState({loadingLihatSTockOpname:!1}),Object(d.e)("info",void 0===e.response?"Terjadi Kesalahan Saat Request Data":e.response.data)})}kosongkanDataBaki(){Object(p.b)("opname/kosongkan").then(e=>{Object(d.e)("success",e.data.message),this.setState({barangKetemu:[],barangHilang:[]})}).catch(e=>{Object(d.e)("info","Terjadi Kesalahan Saat Mengirim Data")})}render(){return o.a.createElement("div",null,o.a.createElement("ol",{className:"breadcrumb float-xl-right"},o.a.createElement("li",{className:"breadcrumb-item"},o.a.createElement(r.b,{to:"#"},"Stock Opname")),o.a.createElement("li",{className:"breadcrumb-item active"},"Stock Opname")),o.a.createElement("h1",{className:"page-header"},"Stock Opname "),o.a.createElement(b.a,null,o.a.createElement(b.c,null,"Stock Opname"),o.a.createElement("br",null),o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-12"},o.a.createElement(h,{loadingLihatSTockOpname:this.state.loadingLihatSTockOpname,lihatstockopname:()=>this.lihatstockopname(),lanjutOpname:()=>this.lanjutOpname(),btnKosongkanDataOpname:()=>this.btnKosongkanDataOpname()})),o.a.createElement("div",{className:"col-12"},o.a.createElement("br",null),o.a.createElement("hr",null),"List Barang Tidak Ketemu",o.a.createElement("hr",null),o.a.createElement(K,{data:this.state.barangHilang,tbl_barang_tidak_ketemu:this.state.tbl_barang_tidak_ketemu})),o.a.createElement("div",{className:"col-12"},o.a.createElement("hr",null),"List Barang Ketemu",o.a.createElement("hr",null),o.a.createElement(j,{data:this.state.barangKetemu,tbl_barang_ketemu:this.state.tbl_barang_ketemu})))),o.a.createElement("br",null),o.a.createElement(c.a,{size:"L",title:"KOSONGKANOPNAME"===this.state.FormModal?"Form Kosongkan Opname":"Proses Opname",content:"KOSONGKANOPNAME"===this.state.FormModal?o.a.createElement(E,{isLoadingBakiOpname:this.state.isLoadingBakiOpname,kosongkanDataBaki:e=>this.kosongkanDataBaki(e),onSubmit:e=>this.btnOpname(e)}):o.a.createElement(y,null)})))}}D=Object(i.a)({form:"FormStockOpname",enableReinitialize:!0})(D);a.default=Object(l.b)()(D)}}]);
//# sourceMappingURL=120.20eb2317.chunk.js.map