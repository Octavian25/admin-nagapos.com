(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{1262:function(a,t,e){"use strict";e.r(t);var i=e(0),s=e.n(i),l=e(41),n=e(31),o=e(53),r=e(330),c=e(69),d=e(30),p=e(72),m=e(11),h=e(329),g=e(23),u=e(13),b=e(94),_=e(54),S=e.n(_);class O extends i.Component{constructor(a){super(a),this.state={isLoading:!1,DataValidasi:[],btnValidasi:!1,kode_sales:!1,warna:!1}}componentDidMount(){this.props.dispatch(Object(u.ub)()),0===this.props.saveValidasiJual.length&&0===this.props.saveValidasiBeli.length&&(localStorage.setItem("validasi_titipan",JSON.stringify([])),localStorage.setItem("validasi_beli",JSON.stringify([])))}getDataSales(a){localStorage.setItem("validasi_titipan",JSON.stringify([])),localStorage.setItem("validasi_beli",JSON.stringify([])),this.setState({kode_sales:a}),Object(m.d)("sales/get/by-kode-sales/"+a).then(a=>{this.props.change("nama_sales",a.data.nama_sales),this.props.dispatch(Object(c.l)([])),this.props.dispatch(Object(c.k)([]))}).catch(a=>{Object(d.e)("info","Gagal Mengambil Data Keserver")})}getDetaValidasi(){let a={kode_sales:this.state.kode_sales};if(!1===a.kode_sales)return Object(d.e)("info","Kode Sales Harus Di pilih"),this.setState({isLoading:!1}),!1;this.setState({isLoading:!0}),"SEMUA"===this.state.kode_sales?Object(m.e)("titip/unvalid",a).then(a=>{if(0===a.data.length)Object(d.e)("info","Belum Ada Data Yang Harus Di Validasi"),this.setState({isLoading:!1}),this.props.change("grandtotal",0);else{let t=0;a.data.forEach(a=>{t+=a.harga_total}),this.props.change("grandtotal",t.toLocaleString("kr-KO")),Object(d.e)("success","Data Validasi Tersedia"),this.setState({isLoading:!1}),this.props.dispatch(Object(c.i)(!0)),localStorage.setItem("validasi_titipan",JSON.stringify(a.data)),this.props.dispatch(Object(c.l)(a.data))}}).catch(a=>{Object(d.e)("info","Terjadi Kesalahan Saat Request"),this.setState({isLoading:!1,DataValidasi:[]})}):Object(m.e)("titip/unvalid/by-sales/"+this.state.kode_sales).then(a=>{if(console.log(a),0===a.data.length)Object(d.e)("info","Belum Ada Data Yang Harus Di Validasi"),this.setState({isLoading:!1}),this.props.change("grandtotal",0);else{let t=0;a.data.forEach(a=>{t+=a.harga_total}),this.props.change("grandtotal",t.toLocaleString("kr-KO")),Object(d.e)("success","Data Validasi Tersedia"),this.setState({isLoading:!1}),this.props.dispatch(Object(c.i)(!0)),localStorage.setItem("validasi_titipan",JSON.stringify(a.data)),this.props.dispatch(Object(c.l)(a.data))}}).catch(a=>{Object(d.e)("info","Terjadi Kesalahan Saat Request"),this.setState({isLoading:!1,DataValidasi:[]})})}render(){const a={mode:"checkbox",clickToSelect:!0,selectColumnPosition:"right",onSelect:(a,t,e,i)=>{if(!0===t){let t={no_titip_group:a.no_titip_group},e=JSON.parse(localStorage.getItem("data_validasi_titip"))||[];-1===e.findIndex(t=>t.no_titip_group===a.no_titip_group)&&(e.push(t),localStorage.setItem("data_validasi_titip",JSON.stringify(e)))}else if(null===localStorage.getItem("data_validasi_titip"));else{let t=JSON.parse(localStorage.getItem("data_validasi_titip"));t.splice(a.no_titip_group,1),localStorage.setItem("data_validasi_titip",JSON.stringify(t))}},onSelectAll:(a,t,e)=>{t.forEach((t,e)=>{if(!0===a){let a={no_titip_group:t.no_titip_group},e=JSON.parse(localStorage.getItem("data_validasi_titip"))||[];-1===e.findIndex(a=>a.no_titip_group===t.no_titip_group)&&(e.push(a),localStorage.setItem("data_validasi_titip",JSON.stringify(e)))}else if(null===localStorage.getItem("data_validasi_titip"));else{let a=JSON.parse(localStorage.getItem("data_validasi_titip"));a.splice(t.no_titip_group,1),localStorage.setItem("data_validasi_titip",JSON.stringify(a))}})}};let t=[{kode_sales:"SEMUA",nama_sales:"SEMUA"}];return this.props.DataSales.forEach(a=>{let e={kode_sales:a.kode_sales,nama_sales:a.nama_sales};t.push(e)}),s.a.createElement("form",{onSubmit:this.props.handleSubmit,autoComplete:"off",onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-3"},s.a.createElement(h.a,{name:"kode_sales",onChange:a=>this.getDataSales(a),label:"Pilih Kode Sales",placeholder:"Masukan Kode Sales",options:t.map(a=>{return{value:a.kode_sales,name:a.nama_sales}}),component:g.f})),s.a.createElement("div",{className:"col-3"},s.a.createElement(h.a,{name:"nama_sales",component:g.e,type:"text",label:"Nama Sales",placeholder:"Masukan Nama Sales",readOnly:!0})),s.a.createElement("div",{className:"col-3"},s.a.createElement(h.a,{name:"grandtotal",component:g.e,type:"text",label:"Grand Total",placeholder:"Grand Total",readOnly:!0,customeCss:this.state.warna?"customeInput":""})),s.a.createElement("div",{className:"col-3"},s.a.createElement("label",null,"\xa0"),s.a.createElement("button",{onClick:()=>this.getDetaValidasi(),className:"btn btn-primary btn-block",disabled:this.state.isLoading,type:"button"},this.state.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Cari Data"):"Cari Data")),s.a.createElement("div",{className:"col-12"},s.a.createElement(p.a,null,s.a.createElement(p.c,null,"List Data Titipan"),s.a.createElement("br",null),s.a.createElement(b.a,{selectRow:a,keyField:"kode_barcode",columns:this.props.columnsJual,data:this.props.saveValidasiJual||[],empty:!0}))),s.a.createElement("div",{className:"col-6"},!1===this.props.btnValidasi?s.a.createElement("button",{className:"btn btn-primary btn-block",disabled:!0,type:"button"},"Validasi"):s.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoading,type:"submit"},this.props.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Validasi"):"Validasi")),s.a.createElement("div",{className:"col-6"},s.a.createElement("button",{className:"btn btn-warning btn-block",disabled:this.props.isLoadingBtl,onClick:this.props.btnClear,type:"button"},this.props.isLoadingBtl?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Batal"):"Batal"))),this.props.isLoading?s.a.createElement(S.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}O=Object(r.a)({form:"HeadValidasiTitipanHutang",enableReinitialize:!0})(O);var f=Object(l.b)(a=>({DataSales:a.datamaster.getDataSales,saveValidasiBeli:a.hutang.saveValidasiBeli,saveValidasiJual:a.hutang.saveValidasiJual,btnValidasi:a.hutang.disableButtonValidasi}))(O);class v extends s.a.Component{constructor(a){super(a),this.state={isLoading:!1,isLoadingBtl:!1,columnsJual:[{dataField:"no_titip_group",text:"No Titip",footer:(a,t,e,i)=>s.a.createElement("div",null,"Total Barang :"," ",null===JSON.parse(localStorage.getItem("validasi_titipan"))?0:JSON.parse(localStorage.getItem("validasi_titipan")).length||0," ")},{dataField:"kode_barcode",text:"Kode Barcode "},{dataField:"nama_barang",text:"Nama Barang",footer:"",footerAttrs:{colSpan:"3"}},{dataField:"nama_atribut",text:"Nama Atribut"},{dataField:"berat",text:"Berat",formatter:a=>a.toFixed(3),footer:a=>a.reduce((a,t)=>a+t,0).toFixed(3)},{dataField:"harga_total",text:"Harga",headerClasses:"text-right",footer:a=>(localStorage.setItem("total_harga_beli",a.reduce((a,t)=>a+t,0)),s.a.createElement("div",{className:"text-right"}," ",a.reduce((a,t)=>a+t,0).toLocaleString("kr-KO"))),formatter:a=>s.a.createElement("div",{className:"text-right"},parseFloat(a).toLocaleString("kr-KO"))}]},this.handleSubmit=this.handleSubmit.bind(this),this.btnClear=this.btnClear.bind(this)}btnClear(){this.setState({isLoadingBtl:!0}),setTimeout(()=>{localStorage.removeItem("validasi_titipan"),localStorage.removeItem("validasi_beli"),this.props.dispatch(Object(o.d)("HeadValidasiJualBeliHutang")),this.props.dispatch(Object(c.l)([])),this.props.dispatch(Object(c.k)([])),this.props.dispatch(Object(c.i)(!1)),this.setState({isLoadingBtl:!1})},1e3)}componentWillUnmount(){this.props.dispatch(Object(c.l)([])),this.props.dispatch(Object(c.k)([]))}handleSubmit(a){let t=JSON.parse(localStorage.getItem("data_validasi_titip"));Object(m.j)("validasi/simpan/jualbeli",t).then(a=>{if(0!==a.data.notabeli.length){let t="";a.data.notabeli.forEach((a,e)=>{let i=a.head.n_alamat_customer.length;t+="========================================\nTanggal          : ".concat(a.head.tgl_system,"\nNama Customer    : ").concat(a.head.nama_customer,"\nNo Hp            : ").concat(a.head.no_hp,"\nAlamat Customer  : ").concat(a.head.n_alamat_customer.split(0,20),"\n"),i>20&&(t+="                   ".concat(a.head.n_alamat_customer.split(0,20),"\n")),i>40&&(t+="                   ".concat(a.head.n_alamat_customer.split(40,20),"\n")),t+="========================================\n",t+="Keterangan\n",t+="========================================\n";let s=0,l=0;a.detail.forEach((a,e)=>{s+=a.harga,l+=a.harga_nota,t+="No Faktur Beli : ".concat(a.no_faktur_beli,"\n"),t+="Jenis Barang   : ".concat(a.kode_dept,"\n"),t+="Nama Barang    : ".concat(a.nama_barang,"\n"),t+="Berat          : ".concat(a.berat.toFixed(3),"\n"),t+="Harga          : ".concat(a.harga.toLocaleString("kr-KO"),"\n"),t+="========================================\n"}),t+="Total          : ".concat(s.toLocaleString("kr-KO"),"\n"),t+="========================================\n",t+="Harga Waktu Beli   : ".concat(s.toLocaleString("kr-KO"),"\n"),t+="Harga Waktu Jual   : ".concat(l.toLocaleString("kr-KO"),"\n"),t+="\n\n\n\n"}),document.getElementById("myInput").value=t,setTimeout(()=>{this.TextFile()},100)}localStorage.removeItem("validasi_titipan"),localStorage.removeItem("validasi_beli"),this.props.dispatch(Object(o.d)("HeadValidasiJualBeliHutang")),this.props.dispatch(Object(c.l)([])),this.props.dispatch(Object(c.k)([])),Object(d.e)("success","Validasi Transaksi Berhasil"),this.props.dispatch(Object(c.i)(!1))}).catch(a=>{console.log(a.response.data),Object(d.e)("info","Terjadi Kesalahaan Saat Mengirim Data")})}TextFile(){const a=document.createElement("a"),t=new Blob([document.getElementById("myInput").value],{type:"text/plain;charset=utf-8"});a.href=URL.createObjectURL(t),a.download="autoprint_pembelian.txt",document.body.appendChild(a),a.click()}render(){return s.a.createElement("div",null,s.a.createElement("ol",{className:"breadcrumb float-xl-right"},s.a.createElement("li",{className:"breadcrumb-item"},s.a.createElement(n.b,{to:"#"},"Kasir")),s.a.createElement("li",{className:"breadcrumb-item active"},"Validasi Titipan")),s.a.createElement("h1",{className:"page-header"},"Validasi Titipan "),s.a.createElement(p.a,null,s.a.createElement(p.c,null,"Validasi Titipan"),s.a.createElement("textarea",{style:{display:"none"},id:"myInput",rows:"100",cols:"100"}),s.a.createElement("br",null),s.a.createElement("div",{className:"container"},s.a.createElement(f,{onSubmit:a=>this.handleSubmit(a),btnClear:()=>this.btnClear(),isLoadingBtl:this.state.isLoadingBtl,columnsBeli:this.state.columnsBeli,columnsJual:this.state.columnsJual})),s.a.createElement("br",null)))}}v=Object(r.a)({form:"FormValidasiTitipan",enableReinitialize:!0})(v);t.default=Object(l.b)()(v)}}]);
//# sourceMappingURL=67.dc1f28ee.chunk.js.map