(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1231:function(a,e,t){"use strict";t.r(e);var n=t(1),l=t(11),r=t(54),s=t.n(r);class i extends n.n.Component{constructor(a){super(a),this.state={date:new Date},this.setStartDate=this.setStartDate.bind(this),this.setLastDate=this.setLastDate.bind(this)}handleSubmit(a){}setStartDate(a){this.setState({tgl_awal:new Date(a)})}setLastDate(a){this.setState({tgl_akhir:new Date(a)})}render(){return n.n.createElement("div",null,n.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},n.n.createElement("div",{className:"row"},n.n.createElement("div",{className:"col-lg-4"},n.n.createElement(n.c,{name:"tgl_awal",component:n.f,label:"Tanggal Dari",type:"text",selected:this.state.tgl_awal,onChange:a=>this.setStartDate(a),placeholder:"Masukan Tanggal Dari"})),n.n.createElement("div",{className:"col-lg-4"},n.n.createElement(n.c,{name:"tgl_akhir",component:n.f,type:"text",selected:this.state.tgl_akhir,onChange:a=>this.setLastDate(a),label:"Tanggal Akhir",placeholder:"Masukan Tanggal Akhir"})),n.n.createElement("div",{className:"col-lg-4"},n.n.createElement("div",{className:"text-right"},n.n.createElement("label",null,"\xa0"),n.n.createElement("button",{type:"submit",value:"PDF",name:"type_btn",className:"btn btn-primary btn-block"},this.props.isLoading?n.n.createElement(n.n.Fragment,null,n.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Mencari"):"Cari Pesanan")))),this.props.isLoading?n.n.createElement(s.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}i=Object(n.O)({form:"HeadPesanan",enableReinitialize:!0})(i);var o=Object(n.u)(a=>({initialValues:{tgl_awal:Object(n.E)(),tgl_akhir:Object(n.E)()}}))(i),m=t(724),c=t(13);const p=Object(n.w)({prefix:"Rp. ",locale:"kr-KO"}),b=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}];class d extends n.b{constructor(a){super(a),this.state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]}}componentDidMount(){this.props.dispatch(Object(c.ub)());let a=JSON.parse(Object(n.I)("data_barang_ambil_pesanan"));setTimeout(()=>{let a=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],e=0;a.forEach(a=>{e=a.nominal+e});let t=Object(n.j)(document.getElementById("grand_total_pembayaran").value);this.props.change("harus_bayar_rp",parseInt(t)-parseInt(e))},100),this.props.change("grand_total_pembayaran",a.total_harga),this.props.change("jenis","CASH"),setTimeout(()=>{document.getElementById("cash_trx_penjualan").focus()},100)}hitungTotal(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}pilihPembyaran(a){"CASH"===a?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===a?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===a?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}render(){return n.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},n.n.createElement("div",{className:"row"},n.n.createElement("div",{className:"col-6"},n.n.createElement(n.c,Object.assign({id:"grand_total_pembayaran",name:"grand_total_pembayaran",component:n.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},p,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),n.n.createElement("div",{className:"col-6"},n.n.createElement(n.c,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:n.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},p,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),n.n.createElement("div",{className:"col-6"},n.n.createElement(n.c,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:b,onChange:a=>this.pilihPembyaran(a),component:n.q})),n.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},n.n.createElement(n.c,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:n.p,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),n.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},n.n.createElement(n.c,{tabIndex:"1",name:"no_card",id:"no_card",component:n.p,type:"text",label:"Card No",placeholder:"Masukan Card No"})),n.n.createElement("div",{className:"col-6"},n.n.createElement(n.c,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:n.p,type:"text",label:"Nominal",onChange:this.hitungTotal()},p,{normalize:n.j,placeholder:"Masukan Nominal"}))),n.n.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},n.n.createElement(n.c,{tabIndex:"1",name:"fee",id:"fee",component:n.p,type:"text",label:"Fee (%)",normalize:n.j,placeholder:"5"})),n.n.createElement("div",{className:"col-6 d-none"},n.n.createElement(n.c,{tabIndex:"1",name:"nominal_kembali",component:n.p,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),n.n.createElement("div",{className:"col-6"},n.n.createElement(n.c,{name:"kembali",id:"sisa_bayar",component:n.p,type:"text",readOnly:!0,label:"Sisa",normalize:n.j,placeholder:"Sisa Pembayaran"})),n.n.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},n.n.createElement("br",null),n.n.createElement("label",null,"\xa0"),n.n.createElement("button",{tabIndex:"2",className:"btn btn-primary"}," ",n.n.createElement("i",{className:"fa fa-plus"})))))}}d=Object(n.O)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:m.a})(d);const h=Object(n.x)("HeadInputPembayaran");var u=Object(n.u)(a=>{const e=h(a,"grand_total_pembayaran","cash"),t=e.cash,n=e.grand_total_pembayaran;let l=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],r=0;l.forEach(a=>{r=a.nominal+r});let s=parseFloat(r||0)-parseFloat(n||0);return{harus_bayar_rp:s,kembali:s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_cash:t,nominal_kembali:s+parseInt(t)}})(d);class g extends n.b{constructor(a){super(a),this.state={isLoading:!1,type_pembayaran:"CASH",kembalian:"",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:a=>n.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e,t)=>n.n.createElement("div",{className:"row text-center"},n.n.createElement("div",{className:"col-12"},n.n.createElement("button",{type:"button",disabled:"DONE"===e.status,onClick:()=>this.hapusdata(t),className:"btn btn-danger mr-3"},n.n.createElement("i",{className:"fa fa-trash"})))),footer:""}]}}hapusdata(a){n.r.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=Object(n.D)("trx_pemabayran_ambil_pesanan");e.splice(a,1),Object(n.Q)("trx_pemabayran_ambil_pesanan",e),this.setState({status:"berhasil"})}})}simpanPembayaran(a){if(void 0===a.no_card&&"CASH"!==a.jenis&&"DEBET"!==a.jenis)return Object(n.t)("info","Nomor kartu tidak boleh kosong"),!1;let e={total_transaksi:a.grand_total_pembayaran,sisa_bayar:a.nominal_kembali};if(void 0===a.nama_bank&&"CASH"!==a.jenis)return Object(n.t)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===a.cash||"0"===a.cash)return Object(n.t)("info","Nominal tidak boleh kosong"),!1;Object(n.Q)("sisa_bayar_pesanan",e);let t=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[];if("CASH"===a.jenis||t.length){if("CASH"!==a.jenis){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&0!==parseInt(a.kembali))return Object(n.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(console.log(a.grand_total_pembayaran),t.reduce((a,e)=>a+e.nominal,0)>=a.grand_total_pembayaran)return Object(n.t)("info","Pembayaran Sudah Cukup1"),!1}}else if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0)return Object(n.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.findIndex(a=>"CASH"===a.jenis)>=0){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&t.reduce((a,e)=>a+e.nominal,0)>a.grand_total_pembayaran)return Object(n.t)("info","Pembayaran Sudah Cukup2"),!1;if(t.reduce((a,e)=>a+e.nominal,0)>=a.grand_total_pembayaran)return Object(n.t)("info","Pembayaran Sudah Cukup3"),!1}if(-1===t.findIndex(e=>e.jenis===a.jenis)){let e="";e="CASH"===a.jenis?"CASH":"TRANSFER"===a.jenis?a.no_card+" - "+a.nama_bank:a.nama_bank;let l={jenis:a.jenis,nominal:parseInt(a.cash)*parseInt(a.fee||0)/100+parseInt(a.cash),nama_bank:a.nama_bank,fee:"CREDIT"===a.jenis&&a.fee||0,no_card:a.no_card||"-",keterangan:e,kembali:a.nominal_kembali};t.push(l),this.setState({masuk:!0,kembalian:a.kembali}),Object(n.Q)("trx_pemabayran_ambil_pesanan",t)}else{let e=Object(n.D)("trx_pemabayran_ambil_pesanan");e=e.map(e=>(e.jenis===a.jenis&&(e.nominal+=parseInt(a.cash)),e)),Object(n.Q)("trx_pemabayran_ambil_pesanan",e),this.setState({status:!0,kembalian:a.kembalian})}}render(){return n.n.createElement(n.n.Fragment,null,n.n.createElement(u,{onSubmit:a=>this.simpanPembayaran(a)}),n.n.createElement("hr",null),n.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},n.n.createElement(n.s,{keyField:"jenis",exportCsv:!1,data:Object(n.D)("trx_pemabayran_ambil_pesanan")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),n.n.createElement("div",{className:"row"},n.n.createElement("div",{className:"col-12 text-right"},n.n.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoadingPembayran,onClick:()=>this.props.simpanPembayaran(),type:"button"},this.props.isLoadingPembayran?n.n.createElement(n.n.Fragment,null,n.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang")))))}}g=Object(n.O)({form:"ModalPembayaran",enableReinitialize:!0,validate:m.a})(g);var _=Object(n.u)(a=>{let e=Object(n.D)("data_barang_pesanan")||[],t="PENJUALAN";return e.forEach(a=>{"-"===a.no_titip_group&&(t="PENJUALAN"),t="-"===a.no_pesanan?"PESANAN":"TITIPAN"}),{status:t}})(g);class E extends n.n.Component{constructor(a){super(a),this.state={isLoading:!1,datapesanan:[],columns:[{dataField:"no_pesanan",text:"No Pesanan",footerAttrs:{colSpan:"3"},footer:"Total"},{dataField:"tanggal_transaksi",text:"Tgl Transaksi"},{dataField:"nama_customer",text:"Nama Customer"},{dataField:"no_hp",text:"Nomor HP"},{dataField:"total_harga",text:"Total Harga",formatter:a=>n.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},{dataField:"jumlah_bayar",text:"Jumlah Pembayaran",formatter:a=>n.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e,t)=>n.n.createElement("div",{className:"row text-center"},n.n.createElement("div",{className:"col-12"},n.n.createElement("button",{type:"button",disabled:"DONE"===e.status_pesanan,"data-tooltip":"DONE"===e.status_pesanan?"Tidak Bisa Dibatal":"Batal Pesanan",onClick:()=>this.batalPesanan(e),className:"btn btn-danger mr-3"},n.n.createElement("i",{className:"fa fa-window-close"})))),footer:""}]},this.handleSubmit=this.handleSubmit.bind(this)}ambilpesanan(a){let e=[];a.pembayaran.forEach(a=>{let t={jenis:a.jenis,keterangan:a.keterangan,nominal:a.jumlah_rp,status:"DONE"};e.push(t)}),Object(n.Q)("trx_pemabayran_ambil_pesanan",e),Object(l.k)("pesanan/ambil/no",{no_pesanan:a.no_pesanan}).then(a=>{Object(n.Q)("data_barang_ambil_pesanan",a.data),this.props.dispatch(Object(n.R)())}).catch(a=>{Object(n.t)("info","Terjadi Kesalahaan Saat Request Data")})}batalPesanan(a){n.r.fire({title:"Anda Yakin !!",text:"Ingin Membatalkan Pesanan Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=Object(n.D)("tgl_laporan");this.setState({isLoading:!0}),Object(l.q)("pesanan/cancel",{no_pesanan:a.no_pesanan}).then(a=>{this.setState({isLoading:!1}),Object(n.t)("success","Pesanan Berhasil Di Batal"),Object(l.e)("pesanan/"+e.tgl_awal+"/"+e.tgl_akhir).then(a=>{let e=[];a.data.forEach(a=>{let t={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};e.push(t)}),this.setState({datapesanan:e,isLoading:!1})})}).catch(a=>{this.setState({isLoading:!1}),Object(n.t)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message)})}})}handleSubmit(a){this.setState({isLoading:!0}),Object(l.e)("pesanan/"+a.tgl_awal+"/"+a.tgl_akhir).then(e=>{0===e.data.length&&Object(n.t)("info","Data Pesanan Tidak Ada");let t=[];e.data.forEach(a=>{let e={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};t.push(e)});let l={tgl_awal:Object(n.y)(Object(n.K)(new Date(a.tgl_awal)).format("YYYY-MM-DD")),tgl_akhir:Object(n.y)(Object(n.K)(new Date(a.tgl_akhir)).format("YYYY-MM-DD"))};this.setState({isLoading:!1,datapesanan:t}),Object(n.Q)("tgl_laporan",l)}).catch(a=>{Object(n.t)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message),this.setState({isLoading:!1})})}render(){const a={renderer:a=>n.n.createElement("div",{className:"container"},n.n.createElement("div",{className:"row"},n.n.createElement("div",{className:"col-12"},"Detail Barang",n.n.createElement("table",null,n.n.createElement("tr",null,n.n.createElement("td",null," Kode Kategori "),n.n.createElement("td",null," Perkiraan Berat "),n.n.createElement("td",null," Perkiraan Kadar "),n.n.createElement("td",null," Harga / Gram "),n.n.createElement("td",null," Attribut "),n.n.createElement("td",null," Harga Attribut "),n.n.createElement("td",null," Kode Barcode "),n.n.createElement("td",null," Ongkos "),n.n.createElement("td",null," Total "),n.n.createElement("td",null," keterangan "),n.n.createElement("td",null," Deskripsi "),n.n.createElement("td",null," Deskripsi Contoh ")),a.detail_barang.map((a,e)=>n.n.createElement(n.n.Fragment,null,n.n.createElement("tr",null,n.n.createElement("td",null," ",a.kode_kategori),n.n.createElement("td",null," ",a.perkiraan_berat.toFixed(3)),n.n.createElement("td",null," ",a.perkiraan_kadar),n.n.createElement("td",null," ",a.harga_gram.toLocaleString("kr-KO")),n.n.createElement("td",null," ",a.attribut),n.n.createElement("td",null," ",a.harga_atribut.toLocaleString("kr-KO")),n.n.createElement("td",null," ",a.kode_barcode),n.n.createElement("td",null," ",a.ongkos.toLocaleString("kr-KO")),n.n.createElement("td",null," ",a.sub_total.toLocaleString("kr-KO")),n.n.createElement("td",null," ",a.keterangan),n.n.createElement("td",null," ",a.deskripsi),n.n.createElement("td",null," ",a.deskripsi_contoh)))))))),showExpandColumn:!0};return n.n.createElement("div",null,n.n.createElement("ol",{className:"breadcrumb float-xl-right"},n.n.createElement("li",{className:"breadcrumb-item"},n.n.createElement(n.g,{to:"#"},"Pesanan")),n.n.createElement("li",{className:"breadcrumb-item active"},"Lihat Pesanan")),n.n.createElement("h1",{className:"page-header"},"Lihat Pesanan "),n.n.createElement(n.k,null,n.n.createElement(n.m,null,"Lihat Pesanan"),n.n.createElement("br",null),n.n.createElement("div",{className:"container"},n.n.createElement(o,{isLoading:this.state.isLoading,onSubmit:a=>this.handleSubmit(a)}),n.n.createElement(n.s,{keyField:"no_pesanan",exportCsv:!1,data:this.state.datapesanan,columns:this.state.columns,empty:!0,textEmpty:"Data Barang Kosong",expandRow:a})),n.n.createElement("br",null),n.n.createElement(n.i,{size:"l",title:"Form Pembayaran",content:n.n.createElement(_,{isLoadingPembayranTitipan:this.state.isLoadingPembayranTitipan,isLoadingPembayran:this.state.isLoadingPembayran,bayarTitipan:a=>this.bayarTitipan(a),simpanPembayaran:a=>this.simpanPembayaranAmbilPesanan(a)})})),this.state.isLoading?n.n.createElement(s.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}E=Object(n.O)({form:"LihatPesanan",enableReinitialize:!0})(E);e.default=Object(n.u)()(E)},724:function(a,e,t){"use strict";e.a=(a=>{const e={};return a.jenis||(e.jenis="Jenis Tidak Boleh Kosong"),e})}}]);
//# sourceMappingURL=33.65952102.chunk.js.map