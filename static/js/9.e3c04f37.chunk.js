(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1216:function(a,e,t){"use strict";t.r(e);var n=t(0),s=t.n(n),r=t(41),o=t(31),i=t(24),l=t.n(i),c=t(154),m=t(72),p=t(53),d=t(330),h=t(13),b=t(7),u=t(228),g=t(30),_=t(94),E=t(11),k=t(735),S=t(329),y=t(23),f=t(95),v=t(743);const O=[{value:"MEMBER",name:"MEMBER"},{value:"NONMEMBER",name:"NON MEMBER"}];class j extends n.Component{constructor(a){super(a),this.state={showMember:!0}}componentDidMount(){this.props.dispatch(Object(h.ub)());let a=null===localStorage.getItem("data_customer_services_tmp")?[]:JSON.parse(localStorage.getItem("data_customer_services_tmp")||[]);a&&"MEMBER"===a.jenis_pelanggan?this.setState({showMember:!1}):(this.setState({showMember:!0}),this.props.change("jenis_pelanggan","NONMEMBER"))}changemember(a){"MEMBER"===a?(this.setState({showMember:!1}),document.getElementById("kode_member").focus()):(document.getElementById("nama_customer").focus(),this.props.change("kode_customer",""),this.props.change("nama_customer",""),this.props.change("no_hp",""),this.props.change("alamat_customer",""),this.setState({showMember:!0}))}getMember(a){Object(E.d)("member/get/by-kode-member/"+a).then(a=>{0===a.data.length?Object(g.e)("info","Member Yang Anda Masukan Tidak Ada !!!"):a.data.forEach((a,e)=>{this.props.change("nama_customer",a.nama_customer),this.props.change("no_hp",a.no_hp),this.props.change("alamat_customer",a.alamat_customer)})}).catch(a=>{Object(g.e)("info","Terjadi Kesalahan SIlahkan Ulangi Kembali !!!")})}render(){return s.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{name:"kode_sales",label:"Pilih Kode Sales",placeholder:"Masukan Kode Sales",options:this.props.DataSales.filter(a=>void 0!==a.kode_sales).map(a=>{return{value:a.kode_sales,name:a.kode_sales}}),component:y.f})),s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{name:"jenis_pelanggan",label:"Pilih Pelanggan",onChange:a=>this.changemember(a),placeholder:"Silahkan Pilih Pelanggan",options:O,component:y.f})),s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{id:"kode_member",name:"kode_customer",onChange:a=>this.getMember(a.target.value),component:y.e,type:"text",readOnly:this.state.showMember,label:"Kode Customer",placeholder:"Masukan Kode Customer"})),s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{id:"nama_customer",name:"nama_customer",component:y.e,type:"text",label:"Nama Customer",placeholder:"Masukan Nama Customer"})),s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{name:"no_hp",component:y.e,type:"text",normalize:f.c,label:"No Hp",placeholder:"Masukan No Hp"})),s.a.createElement("div",{className:"col-4"},s.a.createElement(S.a,{name:"alamat_customer",component:y.e,type:"textarea",label:"Alamat Customer",placeholder:"Masukan Alamat Customer"}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-8"}),s.a.createElement("div",{className:"col-4"},s.a.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoadingDataCustomer,type:"submit"},this.props.isLoadingDataCustomer?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan"):"Simpan Data"))))}}j=Object(d.a)({form:"ModalDataCustomer",enableReinitialize:!0,validate:v.a})(j);var N=Object(r.b)(a=>{let e=null===localStorage.getItem("data_customer_services_tmp")?[]:JSON.parse(localStorage.getItem("data_customer_services_tmp")||[]);return{initialValues:{kode_sales:e.kode_sales||"",jenis_pelanggan:e.jenis_pelanggan||"",kode_customer:e.kode_customer||"",nama_customer:e.nama_customer||"",no_hp:e.no_hp||"",alamat_customer:e.alamat_customer||""},DataSales:a.datamaster.getDataSales}},null)(j),I=t(1),C=t(724);const M=Object(I.w)({prefix:"Rp. ",locale:"kr-KO"}),x=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}];class T extends I.b{constructor(a){super(a),this.state={isLoading:!1,type_pembayaran:"CASH",lebih:!1,columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]},this.setStartDate=this.setStartDate.bind(this)}componentDidMount(){this.props.dispatch(Object(h.ub)());let a=JSON.parse(Object(I.I)("data_barang_services")),e=0;a.forEach((a,t)=>{e+=a.total,this.props.change("grand_total_pembayaran",e),this.props.change("harus_bayar_rp",e)}),this.props.change("jenis","CASH"),setTimeout(()=>{document.getElementById("cash_trx_penjualan").focus()},100)}hitungTotal(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}pilihPembyaran(a){"CASH"===a?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===a?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===a?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}setStartDate(a){this.setState({tgl_awal:new Date(a)})}copyValue(a){this.props.change("cash",parseInt(Object(I.j)(a)))}render(){return I.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},I.n.createElement("div",{className:"row"},I.n.createElement("div",{className:"col-6"},I.n.createElement(I.c,Object.assign({name:"grand_total_pembayaran",component:I.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},M,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),I.n.createElement("div",{className:"col-6"},I.n.createElement(I.c,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:I.p,type:"text",onChange:this.hitungTotal(),readOnly:!0},M,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),I.n.createElement("div",{className:"col-6"},I.n.createElement(I.c,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:x,onChange:a=>this.pilihPembyaran(a),component:I.q})),I.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},I.n.createElement(I.c,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:I.p,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),I.n.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},I.n.createElement(I.c,{tabIndex:"1",name:"no_card",id:"no_card",component:I.p,type:"text",label:"TRANSFER"===this.state.type_pembayaran?"No Rek":"Card No",placeholder:"TRANSFER"===this.state.type_pembayaran?"Masukan No Rek":"Masukan Card No"})),I.n.createElement("div",{className:"col-6"},I.n.createElement(I.c,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:I.p,type:"text",label:"Nominal",onChange:this.hitungTotal()},M,{normalize:I.j,placeholder:"Masukan Nominal"}))),I.n.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},I.n.createElement(I.c,{tabIndex:"1",name:"fee",id:"fee",component:I.p,type:"text",label:"Fee (%)",normalize:I.j,placeholder:"5"})),I.n.createElement("div",{className:"col-6 d-none"},I.n.createElement(I.c,{tabIndex:"1",name:"nominal_kembali",component:I.p,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),I.n.createElement("div",{className:"col-6"},I.n.createElement(I.c,{name:"kembali",id:"sisa_bayar",component:I.p,type:"text",readOnly:!0,label:"Sisa",onFocus:a=>this.copyValue(a.target.value),placeholder:"Sisa Pembayaran"})),I.n.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},I.n.createElement("br",null),I.n.createElement("label",null,"\xa0"),I.n.createElement("button",{tabIndex:"2",disabled:this.props.notif,className:"btn btn-primary"}," ",I.n.createElement("i",{className:"fa fa-plus"})))))}}T=Object(I.O)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:C.a})(T);const B=Object(I.x)("HeadInputPembayaran");var D=Object(I.u)(a=>{const e=B(a,"grand_total_pembayaran","harus_bayar_rp","cash"),t=e.cash,n=e.harus_bayar_rp;let s=JSON.parse(localStorage.getItem("trx_pemabayaran_services"))||[],r=0;s.forEach(a=>{r=a.nominal+r});let o=parseFloat(r||0)-parseFloat(n||0);return{kembali:o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_kembali:o+parseInt(t),initialValues:{estimasi_pesanan:Object(I.E)()}}})(T),w=t(54),R=t.n(w);class A extends I.b{constructor(a){super(a),this.state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:a=>I.n.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e,t)=>I.n.createElement("div",{className:"row text-center"},I.n.createElement("div",{className:"col-12"},I.n.createElement("button",{type:"button",disabled:"TITIPAN"===e.keterangan,onClick:()=>this.hapusdata(t),className:"btn btn-danger mr-3"},I.n.createElement("i",{className:"fa fa-trash"})))),footer:""}]}}hapusdata(a){I.r.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=Object(I.D)("trx_pemabayaran_services");e.splice(a,1),Object(I.Q)("trx_pemabayaran_services",e),this.setState({status:"berhasil"})}})}simpanPembayaran(a){if(void 0===a.no_card&&"CASH"!==a.jenis&&"DEBET"!==a.jenis)return Object(I.t)("info","Nomor kartu tidak boleh kosong"),!1;if(void 0===a.nama_bank&&"CASH"!==a.jenis)return Object(I.t)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===a.cash||"0"===a.cash)return Object(I.t)("info","Nominal tidak boleh kosong"),!1;let e={total_transaksi:a.harus_bayar_rp,sisa_bayar:a.nominal_kembali};Object(I.Q)("sisa_bayar_services",e);let t=JSON.parse(localStorage.getItem("trx_pemabayaran_services"))||[];if("CASH"===a.jenis||t.length){if("CASH"!==a.jenis){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&0!==parseInt(a.kembali))return Object(I.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.reduce((a,e)=>a+e.nominal,0)>=a.harus_bayar_rp)return Object(I.t)("info","Pembayaran Sudah Cukup"),!1}}else if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0)return Object(I.t)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(Object(I.Q)("estimasi_service",Object(I.y)(Object(I.K)(new Date(a.estimasi_service)).format("YYYY-MM-DD"))),t.findIndex(a=>"CASH"===a.jenis)>=0){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&t.reduce((a,e)=>a+e.nominal,0)>a.harus_bayar_rp)return Object(I.t)("info","Pembayaran Sudah Cukup"),!1;if(t.reduce((a,e)=>a+e.nominal,0)>=a.harus_bayar_rp)return Object(I.t)("info","Pembayaran Sudah Cukup"),!1}if(-1===t.findIndex(e=>e.jenis===a.jenis)){let e="";e="CASH"===a.jenis?"CASH":"TRANSFER"===a.jenis?a.no_card+" - "+a.nama_bank:a.nama_bank;let n={jenis:a.jenis,nominal:parseInt(a.cash),nama_bank:void 0!==a.nama_bank?a.nama_bank.toUpperCase():"-",fee:"CREDIT"===a.jenis&&a.fee||0,no_card:a.no_card||"-",keterangan:e.toUpperCase()};t.push(n),this.setState({masuk:!0}),Object(I.Q)("trx_pemabayaran_services",t)}else{let e=Object(I.D)("trx_pemabayaran_services");e=e.map(e=>(e.jenis===a.jenis&&(e.nominal+=parseInt(a.cash)),e)),Object(I.Q)("trx_pemabayaran_services",e),this.setState({status:!0})}}render(){return I.n.createElement(I.n.Fragment,null,I.n.createElement(D,{onSubmit:a=>this.simpanPembayaran(a)}),I.n.createElement("hr",null),I.n.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},I.n.createElement(I.s,{keyField:"jenis",exportCsv:!1,data:Object(I.D)("trx_pemabayaran_services")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),I.n.createElement("div",{className:"row"},I.n.createElement("div",{className:"col-6"}),I.n.createElement("div",{className:"col-6 text-right"},I.n.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoading,onClick:()=>this.props.bayarSekarang(),type:"button"},this.props.isLoading?I.n.createElement(I.n.Fragment,null,I.n.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang"))),this.props.isLoading?I.n.createElement(R.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}A=Object(I.O)({form:"ModalPembayaran",enableReinitialize:!0,validate:C.a})(A);var F=Object(I.u)(a=>{let e=Object(I.D)("data_barang_penjualan_tmp")||[],t="PENJUALAN";return e.forEach(a=>{t="-"===a.no_titip_group?"PENJUALAN":"TITIPAN"}),{status:t}})(A),L=t(333),K=t(73);var J=a=>{const e={};return a.nama_barang||(e.nama_barang="Nama Barang Tidak Boleh Kosong"),a.berat||(e.berat="Berat Tidak Boleh Kosong"),a.ongkos||(e.ongkos="Ongkos Tidak Boleh Kosong"),e};const P=Object(K.createNumberMask)({prefix:"Rp. ",locale:"kr-KO"});class H extends n.Component{constructor(a){super(a),this.state={isLoading:!1,harga_jual:!0,berat_jual:!0,hargapergram:!0,ongkos:!0,total:!0}}componentDidMount(){this.props.dispatch(Object(h.ub)()),setTimeout(()=>{document.getElementById("nama_barang").focus()},100)}getBarcode(a){-1===(JSON.parse(localStorage.getItem("data_barang_penjualan_tmp"))||[]).findIndex(e=>e.kode_barcode===a)?Object(E.d)("barang/get/by-kode-barcode/"+a).then(a=>{0===a.data.length?(Object(g.e)("info","Data Yang Dicari Tidak Ada"),this.props.change("nama_barang",""),this.props.change("nama_atribut",""),this.props.change("berat_atribut",""),this.props.change("harga_atribut",""),this.props.change("berat","")):a.data.forEach((a,e)=>{this.props.change("nama_barang",a.nama_barang),this.props.change("nama_atribut",a.nama_atribut),this.props.change("berat_atribut",a.berat_atribut),this.props.change("harga_atribut",a.harga_atribut),this.props.change("berat",a.berat),this.setState({harga_jual:!1,berat_jual:!1,hargapergram:!1,ongkos:!1})})}).catch(a=>{Object(g.e)("info","Data Yang Dicari Tidak Ada")}):Object(g.e)("info","Barang Sudah Ada Di Tabel")}hitungTotal(){this.props.change("total",this.props.total)}render(){return s.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-md-6"},s.a.createElement(S.a,{tabIndex:"1",id:"nama_barang",name:"nama_barang",label:"Nama Barang",type:"text",placeholder:"Masukan Nama Barang",component:y.e})),s.a.createElement("div",{className:"col-12 col-md-6"},s.a.createElement(S.a,{tabIndex:"2",name:"berat",label:"Berat Barang",onChange:this.hitungTotal(),type:"text",normalize:f.a,placeholder:"Masukan Berat Barang",component:y.e}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-md-6"},s.a.createElement(S.a,{tabIndex:"3",name:"jumlah",label:"Jumlah",type:"number",readOnly:!0,defaultValue:"1",onChange:this.hitungTotal(),placeholder:"Masukan Jumlah",component:y.e})),s.a.createElement("div",{className:"col-12 col-md-6"},s.a.createElement(S.a,Object.assign({tabIndex:"4",name:"ongkos",label:"Ongkos",type:"telp"},P,{placeholder:"Masukan Ongkos",component:y.e})))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-md-12"},s.a.createElement(S.a,Object.assign({name:"total",label:"Total",type:"telp",readOnly:!0,placeholder:"Masukan Total",component:y.e},P))),s.a.createElement("div",{className:"col-12 col-md-12"},s.a.createElement(S.a,{tabIndex:"5",name:"deskripsi",label:"Deskripsi",type:"textarea",placeholder:"Masukan Deskripsi",component:y.e}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-6"}),s.a.createElement("div",{className:"col-6"},s.a.createElement("button",{tabIndex:"6",className:"btn btn-primary btn-block",disabled:this.props.submitting,type:"submit"},this.props.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan"):"Simpan Data"))))}}H=Object(d.a)({form:"ModalTambahBarang",enableReinitialize:!0,validate:J})(H);var U=Object(r.b)(a=>{const e=Object(L.a)("ModalTambahBarang")(a,"ongkos","jumlah"),t=e.ongkos,n=e.jumlah;return{initialValues:{jumlah:"1"},total:parseFloat(t||0)*parseFloat(n||0)||0,DataSales:a.datamaster.getDataSales}})(H);class Y extends n.Component{constructor(a){super(a),this.state={isLoading:!1,isLoadingBatal:!1,isLoadingDataCustomer:!1,FormModal:""}}componentDidMount(){this.props.dispatch(Object(h.ub)())}getBarcode(a){Object(E.d)("barang/get/by-kode-barcode/"+a).then(a=>{0===a.data.length?(Object(g.e)("info","Data Yang Dicari Tidak Ada"),this.props.change("nama_barang",""),this.props.change("nama_atribut",""),this.props.change("berat_atribut",""),this.props.change("harga_atribut","")):a.data.forEach((a,e)=>{this.props.change("nama_barang",a.nama_barang),this.props.change("nama_atribut",a.nama_atribut),this.props.change("berat_atribut",a.berat_atribut),this.props.change("harga_atribut",a.harga_atribut)})}).catch(a=>{Object(g.e)("info","Data Yang Dicari Tidak Ada")})}handleSubmit(a){let e={alamat_customer:a.alamat_customer||"-",jenis_pelanggan:a.jenis_pelanggan||"NONMEMBER",kode_customer:"NONMEMBER"===a.jenis_pelanggan?"NONMEMBER":a.kode_customer,kode_sales:a.kode_sales,nama_customer:a.nama_customer||"REGULER",no_hp:a.no_hp||"-"};this.setState({isLoadingDataCustomer:!0}),localStorage.setItem("data_customer_services_tmp",JSON.stringify(e)),setTimeout(()=>{this.setState({isLoadingDataCustomer:!1}),this.props.dispatch(Object(h.Cb)())},500)}simpanBarang(a){a={nama_barang:a.nama_barang.toUpperCase()||"-",berat:parseFloat(a.berat)||0,jumlah:parseFloat(a.jumlah)||0,ongkos:parseInt(a.ongkos)||0,total:parseInt(a.total)||0,deskripsi:void 0===a.deskripsi?a.nama_barang.toUpperCase():a.deskripsi.toUpperCase()||"-"};let e=JSON.parse(localStorage.getItem("data_barang_services"))||[];this.props.dispatch(Object(p.d)("ModalTambahBarang")),document.getElementById("nama_barang").focus(),e.push(a),localStorage.setItem("data_barang_services",JSON.stringify(e)),this.props.dispatch(Object(c.d)(e)),this.props.dispatch(Object(h.Cb)()),Object(g.e)("success","Barang Berhasil Ditambahkan"),this.props.change("nama_barang","")}bayarSekarang(a){if(Object(b.g)("trx_pemabayaran_services").length<=0)return Object(g.e)("info","Mohon Tambahkan metode pembayaran minimal 1.."),!1;this.setState({isLoading:!0});let e=Object(b.g)("trx_pemabayaran_services"),t=[],n=0,s=0;e.forEach(a=>{"CASH"===a.jenis?(s=parseInt(a.nominal)<=Math.abs(parseInt(Object(b.g)("sisa_bayar_services").sisa_bayar))?Math.abs(parseInt(Object(b.g)("sisa_bayar_services").sisa_bayar)-parseInt(a.nominal)):parseInt(a.nominal),s=parseInt(a.nominal)>=Math.abs(parseInt(Object(b.g)("sisa_bayar_services").total_transaksi))?parseInt(a.nominal)-Math.abs(parseInt(Object(b.g)("sisa_bayar_services").sisa_bayar)):parseInt(a.nominal)):s=parseInt(a.nominal);let e={jenis:a.jenis,keterangan:a.keterangan,fee:"CREDIT"===a.jenis&&parseInt(a.fee)||0,jumlah_rp:s};n=a.nominal+n,t.push(e)});let r=JSON.parse(localStorage.getItem("data_customer_services_tmp")),o=JSON.parse(localStorage.getItem("data_barang_services")),i=[];o.forEach((a,e)=>{let t={nama_barang:a.nama_barang,berat:a.berat,jumlah:a.jumlah,ongkos:a.ongkos,total_rp:a.total_rp,deskripsi:a.deskripsi};i.push(t)});let l={kode_sales:r.kode_sales,nama_customer:r.nama_customer,kode_member:"NONMEMBER"===r.jenis_pelanggan?r.jenis_pelanggan:r.kode_customer,alamat_customer:r.alamat_customer,no_hp:r.no_hp,total:parseInt(Object(b.g)("sisa_bayar_services").total_transaksi),dp_rp:parseInt(n)<parseInt(Object(b.g)("sisa_bayar_services").total_transaksi)?parseInt(n):parseInt(n)>=parseInt(Object(b.g)("sisa_bayar_services").total_transaksi)?parseInt(Object(b.g)("sisa_bayar_services").total_transaksi):0,detail_barang:i,pembayaran:t};Object(E.j)("service/simpan",l).then(a=>{this.setState({isLoading:!1}),Object(g.e)("success","Transksi Service Berhasil");let e=[];for(let t=0;t<2;t++){let t="";a.data.forEach((a,e)=>{let n=a.n_alamat_customer.length;t+="========================================\n",t+="             NOTA SERVICE               \n",t+="========================================\nTanggal          : ".concat(a.tgl_system,"\nKode Sales       : ").concat(a.kode_sales,"\nNama Customer    : ").concat(a.nama_customer,"\nNo Hp            : ").concat(a.no_hp,"\nAlamat Customer  : ").concat(a.n_alamat_customer.slice(0,20),"\nTotal Service    : ").concat(a.total_service.toLocaleString("kr-KO"),"\n"),n>20&&(t+="      ".concat(a.n_alamat_customer.slice(20,40),"\n")),n>40&&(t+="      ".concat(a.n_alamat_customer.slice(40,60),"\n")),t+="========================================\n",t+="Keterangan\n",t+="========================================\n";let s=0,r=0;a.detail_barang.forEach((e,n)=>{s+=e.ongkos;let o=e.deskripsi.length;r+=e.harga_nota,t+="Nama Barang      : ".concat(e.nama_barang,"\n"),t+="Berat            : ".concat(e.berat.toFixed(3),"\n"),t+="Jumlah           : ".concat(e.jumlah.toLocaleString("kr-KO"),"\n"),t+="Ongkos           : ".concat(e.ongkos.toLocaleString("kr-KO"),"\n"),t+="deskripsi        : ".concat(e.deskripsi.slice(0,20),"\n"),o>20&&(t+="                   ".concat(a.deskripsi.slice(20,40))),o>40&&(t+="                   ".concat(a.deskripsi.slice(40,60))),t+="========================================\n"}),t+="Total Ongkos     : ".concat(s.toLocaleString("kr-KO"),"\n"),t+="========================================\n",t+="                               TTD      \n",t+="                                        \n",t+="                                        \n",t+="                                        \n",t+="                         (             )\n",t+="                                        \n",t+="                                        \n",t+="                                        \n"}),e.push(t)}document.getElementById("myInput").value=e.join("")}).then(()=>{const a=document.createElement("a"),e=new Blob([document.getElementById("myInput").value],{type:"text/plain;charset=utf-8"});a.href=URL.createObjectURL(e),a.download="autoprint_service.txt",document.body.appendChild(a),a.click()}).then(()=>{this.props.dispatch(Object(h.Cb)())}).then(()=>{this.props.dispatch(Object(p.d)("ModalPembayaran"))}).then(()=>{localStorage.setItem("data_customer_services_tmp",JSON.stringify([])),localStorage.setItem("data_barang_services",JSON.stringify([])),localStorage.setItem("sisa_bayar_services",JSON.stringify([])),localStorage.setItem("trx_pemabayaran_services",JSON.stringify([])),this.setState({isLoading:!1})}).then(()=>{this.props.dispatch(Object(c.d)([]))}).catch(a=>this.errorhandling(a))}errorhandling(a){console.log(a),this.setState({isLoading:!1}),Object(g.e)("info","Transaksi Gagal Disimpan")}ShowModalBarang(){this.props.dispatch(Object(h.Db)()),this.setState({FormModal:"ShowModalBarang"})}ShowModalCustomer(){this.setState({FormModal:"ShowModalCustomer"}),this.props.dispatch(Object(h.Db)())}showModalPembayaran(){let a=JSON.parse(localStorage.getItem("data_customer_services_tmp"))||[],e=JSON.parse(localStorage.getItem("data_barang_services"))||[];0===a.length||0===e.length?Object(g.e)("info","Data Customer Atau Data Barang Belum Diisi !!!"):(this.setState({FormModal:"ShowModalPembayaran"}),this.props.dispatch(Object(h.Db)()))}batalServices(){this.setState({isLoadingBatal:!0}),setTimeout(()=>{localStorage.setItem("data_customer_services_tmp",JSON.stringify([])),this.props.dispatch(Object(c.d)([])),localStorage.setItem("data_barang_services",JSON.stringify([])),this.setState({isLoadingBatal:!1})},500)}render(){return s.a.createElement(m.a,null,s.a.createElement("textarea",{style:{display:"none"},id:"myInput",rows:"100",cols:"100"}),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12"},s.a.createElement(_.a,{keyField:"nama_barang",exportCsv:!1,data:0===this.props.setTransaksiServices.length?JSON.parse(localStorage.getItem("data_barang_services"))||[]:this.props.setTransaksiServices||[],tambahData:!0,btnText:"Tambah Data Customer",columns:this.props.columns,btnOptional:!0,namaCustomer:!0,jenisCustomer:!0,form:"Service",btnTextOptional:"Tambah Data Barang",handleClick:()=>this.ShowModalCustomer(),handleClickOptional:()=>this.ShowModalBarang(),empty:!0,textEmpty:"Data Barang Kosong"}))),s.a.createElement(u.a,{size:"ShowModalCustomer"===this.state.FormModal?"xl":"ShowModalBarang"===this.state.FormModal?"L":"P",title:s.a.createElement(z,{state:this.state.FormModal}),content:"ShowModalCustomer"===this.state.FormModal?s.a.createElement(N,{isLoadingDataCustomer:this.state.isLoadingDataCustomer,onSubmit:a=>this.handleSubmit(a)}):"ShowModalBarang"===this.state.FormModal?s.a.createElement(U,{onSubmit:a=>this.simpanBarang(a)}):s.a.createElement(F,{isLoading:this.state.isLoading,bayarSekarang:a=>this.bayarSekarang(a)})}),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-4"},s.a.createElement("button",{onClick:()=>this.showModalPembayaran(),className:"btn btn-primary",disabled:this.props.isLoading,type:"submit"},this.props.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan"):"Simpan Data Services"),"\xa0",s.a.createElement("button",{onClick:()=>this.batalServices(),className:"btn btn-warning",disabled:this.state.isLoadingBatal,type:"button"},this.state.isLoadingBatal?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Reset"):"Reset"))))}}function z(a,e){return"ShowModalCustomer"===a.state?"Form Data Customer":"ShowModalBarang"===a.state?"Form Data Barang":"Form Pembayaran"}Y=Object(d.a)({form:"HeadServices",enableReinitialize:!0,validate:k.a})(Y);var V=Object(r.b)(a=>({setTransaksiServices:a.services.setTransaksiServices,DataSales:a.datamaster.getDataSales,hideModal:a.datamaster.modalDialog}),null)(Y);e.default=Object(r.b)(a=>({dataservices:a.services.setTransaksiServices}),null)(class extends s.a.Component{constructor(a){super(a),this.state={isLoading:!1,columns:[{dataField:"nama_barang",text:"Nama Barang",footer:"Total"},{dataField:"berat",text:"Berat",footer:a=>a.reduce((a,e)=>a+e,0).toFixed(1)},{dataField:"jumlah",text:"Jumlah",formatter:a=>s.a.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"ongkos",text:"Ongkos",formatter:a=>s.a.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"total",text:"Total Rp",formatter:a=>s.a.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"deskripsi",text:"Deskripsi",footer:""},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e,t)=>s.a.createElement("div",{className:"row text-center"},s.a.createElement("div",{className:"col-12"},s.a.createElement("button",{type:"button",onClick:()=>this.hapusdata(t),className:"btn btn-danger mr-3"},s.a.createElement("i",{className:"fa fa-trash"})))),footer:""}]},this.handleSubmit=this.handleSubmit.bind(this)}hapusdata(a){l.a.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=JSON.parse(localStorage.getItem("data_barang_services"));e.splice(a,1),localStorage.setItem("data_barang_services",JSON.stringify(e)),this.props.dispatch(Object(c.d)(e)),this.setState({berhasil:!0})}})}componentWillUnmount(){localStorage.setItem("data_customer_services_tmp",JSON.stringify([])),localStorage.setItem("data_barang_services",JSON.stringify([]))}handleSubmit(a){}render(){return s.a.createElement("div",null,s.a.createElement("ol",{className:"breadcrumb float-xl-right"},s.a.createElement("li",{className:"breadcrumb-item"},s.a.createElement(o.b,{to:"#"},"Services")),s.a.createElement("li",{className:"breadcrumb-item active"},"Transaksi Services")),s.a.createElement("h1",{className:"page-header"},"Transaksi Services "),s.a.createElement(m.a,null,s.a.createElement(m.c,null,"Transaksi Services"),s.a.createElement("br",null),s.a.createElement("div",{className:"container"},s.a.createElement(V,{isLoading:this.state.isLoading,columns:this.state.columns})),s.a.createElement("br",null)))}})},724:function(a,e,t){"use strict";e.a=(a=>{const e={};return a.jenis||(e.jenis="Jenis Tidak Boleh Kosong"),e})},735:function(a,e,t){"use strict";e.a=(a=>{const e={};return a.user_id||(e.user_id="User Id Tidak Boleh Kosong"),a.user_name||(e.user_name="Username Tidak Boleh Kosong"),a.level||(e.level="Level Harus Dipilih "),e})},743:function(a,e,t){"use strict";e.a=(a=>{const e={};return a.kode_sales||(e.kode_sales="Kode Sales Harus Dipilih"),a.nama_customer||(e.nama_customer="Nama Customer Harus Diisi"),a.no_hp||(e.no_hp="No Hp Harus Diisi"),a.alamat||(e.alamat="Alamat Harus Diisi"),e})}}]);
//# sourceMappingURL=9.e3c04f37.chunk.js.map